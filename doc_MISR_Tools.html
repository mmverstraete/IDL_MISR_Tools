<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN"
    "http://www.w3.org/TR/html4/strict.dtd">
<html lang="en">
   <head>
      <meta http-equiv="content-type" content="text/html; charset=utf-8">
      <title>Documentation for the IDL routines in project MISR_Tools</title>
   </head>
<body>
<h1>Documentation for the IDL routines in project MISR_Tools</h1>
<h2>block2str</h2>
<ul>
<li><p><strong>Purpose:</strong> This function converts a valid <span class="smallcaps">MISR</span> <span class="smallcaps">Block</span> number into a properly formatted <code>STRING</code>, with or without the <code>B</code> header.</p></li>
<li><p><strong>Algorithm:</strong> This function converts the input positional parameter <code>misr_block</code>, provided as an <code>INT</code> value, into a zero-padded <code>STRING</code> formatted as <code>Bzzz</code> (by default), or as <code>zzz</code> if the optional input keyword parameter <code>NOHEADER</code> is set.</p></li>
<li><p><strong>Syntax:</strong> <code>rc = block2str(misr_block, misr_block_str, $</code><br />
<code>NOHEADER = noheader, DEBUG = debug, EXCPT_COND = excpt_cond)</code></p></li>
<li><p><strong>Positional parameters [Input/Output]:</strong></p>
<ul>
<li><p><code>misr_block {INT} [I]:</code> The selected <span class="smallcaps">MISR</span> <span class="smallcaps">Block</span> number.</p></li>
<li><p><code>misr_block_str {STRING} [O]:</code> A <code>STRING</code> representation of the <span class="smallcaps">MISR</span> <span class="smallcaps">Block</span> with or without the <code>B</code> header, depending on the input keyword parameter <code>NOHEADER</code>.</p></li>
</ul></li>
<li><p><strong>Keyword parameters [Input/Output]:</strong></p>
<ul>
<li><p><code>NOHEADER = noheader{INT} [I] (Default value: 0):</code> Flag to avoid (<code>1</code>) or add (<code>0</code>) the header <code>B</code> to the ouput positional parameter <code>misr_block_str</code>.</p></li>
<li><p><code>DEBUG = debug {INT} [I] (Default value: 0):</code> Flag to activate (<code>1</code>) or skip (<code>0</code>) debugging tests.</p></li>
<li><p><code>EXCPT_COND = excpt_cond {STRING} [O] (Default value: &#8221;):</code> Description of the exception condition if one has been encountered, or a null string otherwise.</p></li>
</ul></li>
<li><p><strong>Returned value type:</strong> <code>INT</code>.</p></li>
<li><p><strong>Outcome:</strong></p>
<ul>
<li><p>If no exception condition has been detected, this function returns <code>0</code>, and the output keyword parameter <code>excpt_cond</code> is set to a null string, if the optional input keyword parameter <code>DEBUG</code> was set and if the optional output keyword parameter <code>EXCPT_COND</code> was provided in the call. The output positional parameter <code>misr_block_str</code> contains the string version of the <span class="smallcaps">Block</span>, with or without the <code>B</code> header.</p></li>
<li><p>If an exception condition has been detected, this function returns a non-zero error code, and the output keyword parameter <code>excpt_cond</code> contains a message about the exception condition encountered, if the optional input keyword parameter <code>DEBUG</code> is set and if the optional output keyword parameter <code>EXCPT_COND</code> is provided. The output positional parameter <code>misr_block_str</code> is set to a null <code>STRING</code>.</p></li>
</ul></li>
<li><p><strong>Exception conditions:</strong></p>
<ul>
<li><p>Error 100: One or more positional parameter(s) are missing.</p></li>
<li><p>Error 110: Input positional parameter <code>misr_block</code> is invalid.</p></li>
</ul></li>
<li><p><strong>Dependencies:</strong></p>
<ul>
<li><p><code>chk_misr_block.pro</code></p></li>
<li><p><code>strstr.pro</code></p></li>
</ul></li>
<li><p><strong>Remarks:</strong></p>
<ul>
<li><p><strong>Note 1:</strong> A <code>STRING</code> value containing only digits for the input positional argument <code>misr_block</code> is tolerated and results in correct output positional argument <code>misr_block_str</code> if the input keyword parameter <code>DEBUG</code> is NOT set, but an error message is issued if this keyword is set, because this situation likely corresponds to an unintentional incorrect user call (see the last example below).</p></li>
</ul></li>
<li><p><strong>Examples:</strong></p>
<pre><code>IDL&gt; misr_block = 90
IDL&gt; rc = block2str(misr_block, misr_block_str, $
   /DEBUG, EXCPT_COND = excpt_cond)
IDL&gt; PRINT, &#39;rc = &#39;, rc, &#39;, excpt_cond = &gt;&#39; + excpt_cond + &#39;&lt;&#39;
rc =            0, excpt_cond = &gt;&lt;
IDL&gt; PRINT, &#39;misr_block_str = &gt;&#39; + misr_block_str +&#39;&lt;&#39;
misr_block_str = &gt;B090&lt;

IDL&gt; misr_block = 89
IDL&gt; rc = block2str(misr_block, misr_block_str, $
   /NOHEADER, /DEBUG, EXCPT_COND = excpt_cond)
IDL&gt; PRINT, &#39;rc = &#39;, rc, &#39;, excpt_cond = &gt;&#39; + excpt_cond + &#39;&lt;&#39;
rc =            0, excpt_cond = &gt;&lt;
IDL&gt; PRINT, &#39;misr_block_str = &gt;&#39; + misr_block_str +&#39;&lt;&#39;
misr_block_str = &gt;089&lt;

IDL&gt; misr_block = &#39;88&#39;
IDL&gt; rc = block2str(misr_block, misr_block_str)
IDL&gt; PRINT, &#39;rc = &#39; + strstr(rc)
rc = 0
IDL&gt; PRINT, &#39;misr_block_str = &gt;&#39; + misr_block_str + &#39;&lt;&#39;
misr_block_str = &gt;B088&lt;

IDL&gt; misr_block = &#39;87&#39;
IDL&gt; rc = block2str(misr_block, misr_block_str, $
   /NOHEADER, /DEBUG, EXCPT_COND = excpt_cond)
IDL&gt; PRINT, &#39;rc = &#39;, rc, &#39; excpt_cond = &gt;&#39; + excpt_cond + &#39;&lt;&#39;
rc =      110 excpt_cond = &gt;Error 110 in BLOCK2STR:
   Error 110 in CHK_MISR_BLOCK: Input positional parameter
   misr_block must be of numeric type.&lt;
IDL&gt; PRINT, &#39;misr_block_str = &gt;&#39; + misr_block_str +&#39;&lt;&#39;
misr_block_str = &gt;&lt;</code></pre></li>
<li><p><strong>References:</strong> None.</p></li>
<li><p><strong>Versioning:</strong></p>
<ul>
<li><p>2017&#8211;11&#8211;15: Version 0.9 &#8212; Initial release.</p></li>
<li><p>2017&#8211;11&#8211;30: Version 1.0 &#8212; Initial public release.</p></li>
<li><p>2018&#8211;01&#8211;16: Version 1.1 &#8212; Implement optional debugging.</p></li>
<li><p>2018&#8211;05&#8211;14: Version 1.2 &#8212; Minor update.</p></li>
<li><p>2018&#8211;06&#8211;01: Version 1.5 &#8212; Implement new coding standards.</p></li>
<li><p>2019&#8211;01&#8211;28: Version 2.00 &#8212; Systematic update of all routines to implement stricter coding standards and improve documentation.</p></li>
<li><p>2019&#8211;08&#8211;20: Version 2.1.0 &#8212; Adopt revised coding and documentation standards (in particular regarding the assignment of numeric return codes), and switch to 3-parts version identifiers.</p></li>
</ul></li>
</ul>
<h2>chk_misr_band</h2>
<ul>
<li><p><strong>Purpose:</strong> This function checks the validity of the input positional parameter <code>misr_band</code>.</p></li>
<li><p><strong>Algorithm:</strong> This function indicates whether the value of the input positional parameter <code>misr_band</code> is one of <code>[&#8217;Blue&#8217;, &#8217;Green&#8217;, &#8217;Red&#8217;, &#8217;NIR&#8217;]</code>.</p></li>
<li><p><strong>Syntax:</strong> <code>rc = chk_misr_band(misr_band, $</code><br />
<code>DEBUG = debug, EXCPT_COND = excpt_cond)</code></p></li>
<li><p><strong>Positional parameters [Input/Output]:</strong></p>
<ul>
<li><p><code>misr_band {STRING} [I/O]:</code> The selected <span class="smallcaps">MISR</span> spectral <span class="smallcaps">Band</span> name.</p></li>
</ul></li>
<li><p><strong>Keyword parameters [Input/Output]:</strong></p>
<ul>
<li><p><code>DEBUG = debug {INT} [I] (Default value: 0):</code> Flag to activate (<code>1</code>) or skip (<code>0</code>) debugging tests.</p></li>
<li><p><code>EXCPT_COND = excpt_cond {STRING} [O] (Default value: &#8221;):</code> Description of the exception condition if one has been encountered, or a null string otherwise.</p></li>
</ul></li>
<li><p><strong>Returned value type:</strong> <code>INT</code>.</p></li>
<li><p><strong>Outcome:</strong></p>
<ul>
<li><p>If no exception condition has been detected, this function returns <code>0</code>, and the output keyword parameter <code>excpt_cond</code> is set to a null string, if the optional input keyword parameter <code>DEBUG</code> is set and if the optional output keyword parameter <code>EXCPT_COND</code> is provided in the call. Upon exiting this function, the <code>I/O</code> positional parameter <code>misr_band</code> is a valid properly capitalized <span class="smallcaps">Band</span> name.</p></li>
<li><p>If an exception condition has been detected, this function returns a non-zero error code, and the output keyword parameter <code>excpt_cond</code> contains a message about the exception condition encountered, if the optional input keyword parameter <code>DEBUG</code> is set and if the optional output keyword parameter <code>EXCPT_COND</code> is provided. The input positional parameter <code>misr_band</code> is invalid.</p></li>
</ul></li>
<li><p><strong>Exception conditions:</strong></p>
<ul>
<li><p>Error 100: One or more positional parameter(s) are missing.</p></li>
<li><p>Error 110: Input positional parameter <code>misr_band</code> is not of type <code>STRING</code>.</p></li>
<li><p>Error 120: Input positional parameter <code>misr_band</code> is not a scalar.</p></li>
<li><p>Error 200: An exception condition occurred in <code>set_cap.pro</code>.</p></li>
<li><p>Error 210: Input positional parameter <code>misr_band</code> is invalid: must be one of<br />
<code>[&#8217;Blue&#8217;, &#8217;Green&#8217;, &#8217;Red&#8217;, &#8217;NIR&#8217;]</code>.</p></li>
</ul></li>
<li><p><strong>Dependencies:</strong></p>
<ul>
<li><p><code>is_scalar.pro</code></p></li>
<li><p><code>is_string.pro</code></p></li>
<li><p><code>set_cap.pro</code></p></li>
<li><p><code>set_misr_specs.pro</code></p></li>
<li><p><code>strstr.pro</code></p></li>
</ul></li>
<li><p><strong>Remarks:</strong></p>
<ul>
<li><p><strong>Note 1:</strong> Since the purpose of this function is to check the validity of the input positional parameter <code>misr_band</code>, all tests are performed irrespective of the setting of the input keyword parameter <code>DEBUG</code>. The keywords <code>DEBUG</code> and <code>EXCPT_COND</code> are included for consistency, and to allow reporting of the exception condition if one is encountered.</p></li>
<li><p><strong>Note 2:</strong> The input positional parameter <code>misr_band</code> is properly capitalized on output.</p></li>
</ul></li>
<li><p><strong>Examples:</strong></p>
<pre><code>IDL&gt; misr_band = &#39;nir&#39;
IDL&gt; rc = chk_misr_band(misr_band, /DEBUG, $
   EXCPT_COND = excpt_cond)
IDL&gt; PRINT, &#39;rc = &#39; + strstr(rc) + &#39;, $
   excpt_cond = &gt;&#39; + excpt_cond + &#39;&lt;&#39;
rc = 0, excpt_cond = &gt;&lt;
IDL&gt; PRINT, &#39;misr_band = &#39;, misr_band
misr_band = NIR

IDL&gt; misr_band = &#39;violet&#39;
IDL&gt; rc = chk_misr_band(misr_band, $
   /DEBUG, EXCPT_COND = excpt_cond)
IDL&gt; PRINT, &#39;rc = &#39; + strstr(rc) + $
   &#39;, excpt_cond = &gt;&#39; + excpt_cond + &#39;&lt;&#39;
rc = 210, excpt_cond = &gt;Error 210 in CHK_MISR_BAND:
Invalid misr_band name: must be one of [&#39;Blue&#39;, &#39;Green&#39;,
   &#39;Red&#39;, &#39;NIR&#39;].&lt;
IDL&gt; PRINT, &#39;misr_band = &#39;, misr_band
misr_band = Violet</code></pre></li>
<li><p><strong>References:</strong> None.</p></li>
<li><p><strong>Versioning:</strong></p>
<ul>
<li><p>2017&#8211;11&#8211;15: Version 0.9 &#8212; Initial release.</p></li>
<li><p>2017&#8211;11&#8211;30: Version 1.0 &#8212; Initial public release.</p></li>
<li><p>2018&#8211;01&#8211;16: Version 1.1 &#8212; Implement optional debugging.</p></li>
<li><p>2018&#8211;06&#8211;01: Version 1.5 &#8212; Implement new coding standards.</p></li>
<li><p>2019&#8211;01&#8211;28: Version 2.00 &#8212; Systematic update of all routines to implement stricter coding standards and improve documentation.</p></li>
<li><p>2019&#8211;02&#8211;06: Version 2.01 &#8212; Minor coding update.</p></li>
<li><p>2019&#8211;08&#8211;20: Version 2.1.0 &#8212; Adopt revised coding and documentation standards (in particular regarding the assignment of numeric return codes), and switch to 3-parts version identifiers.</p></li>
</ul></li>
</ul>
<h2>chk_misr_block</h2>
<ul>
<li><p><strong>Purpose:</strong> This function checks the validity of the input positional parameter <code>misr_block</code>.</p></li>
<li><p><strong>Algorithm:</strong> This function indicates whether the value of the input positional parameter <code>misr_block</code> is within <code>[1, 180]</code>.</p></li>
<li><p><strong>Syntax:</strong> <code>rc = chk_misr_block(misr_block, $</code><br />
<code>DEBUG = debug, EXCPT_COND = excpt_cond)</code></p></li>
<li><p><strong>Positional parameters [Input/Output]:</strong></p>
<ul>
<li><p><code>misr_block {INT} [I/O]:</code> The selected <span class="smallcaps">MISR</span> <span class="smallcaps">Block</span> number.</p></li>
</ul></li>
<li><p><strong>Keyword parameters [Input/Output]:</strong></p>
<ul>
<li><p><code>DEBUG = debug {INT} [I] (Default value: 0):</code> Flag to activate (<code>1</code>) or skip (<code>0</code>) debugging tests.</p></li>
<li><p><code>EXCPT_COND = excpt_cond {STRING} [O] (Default value: &#8221;):</code> Description of the exception condition if one has been encountered, or a null string otherwise.</p></li>
</ul></li>
<li><p><strong>Returned value type:</strong> <code>INT</code>.</p></li>
<li><p><strong>Outcome:</strong></p>
<ul>
<li><p>If no exception condition has been detected, this function returns <code>0</code>, and the output keyword parameter <code>excpt_cond</code> is set to a null string, if the optional input keyword parameter <code>DEBUG</code> is set and if the optional output keyword parameter <code>EXCPT_COND</code> is provided in the call. Upon exiting this function, the <code>I/O</code> positional parameter <code>misr_block</code> is a valid <span class="smallcaps">Block</span> number.</p></li>
<li><p>If an exception condition has been detected, this function returns a non-zero error code, and the output keyword parameter <code>excpt_cond</code> contains a message about the exception condition encountered, if the optional input keyword parameter <code>DEBUG</code> is set and if the optional output keyword parameter <code>EXCPT_COND</code> is provided. The input positional parameter <code>misr_block</code> is invalid.</p></li>
</ul></li>
<li><p><strong>Exception conditions:</strong></p>
<ul>
<li><p>Error 100: One or more positional parameter(s) are missing.</p></li>
<li><p>Error 110: Input positional parameter <code>misr_block</code> is not of type numeric.</p></li>
<li><p>Error 120: Input positional parameter <code>misr_block</code> is not a scalar.</p></li>
<li><p>Error 200: Input positional parameter <code>misr_block</code> is invalid: must be within [1, 180].</p></li>
</ul></li>
<li><p><strong>Dependencies:</strong></p>
<ul>
<li><p><code>is_numeric.pro</code></p></li>
<li><p><code>is_scalar.pro</code></p></li>
<li><p><code>strstr.pro</code></p></li>
</ul></li>
<li><p><strong>Remarks:</strong></p>
<ul>
<li><p><strong>Note 1:</strong> Since the purpose of this function is to check the validity of the input positional parameter <code>misr_block</code>, all tests are performed irrespective of the setting of the input keyword parameter <code>DEBUG</code>. The keywords <code>DEBUG</code> and <code>EXCPT_COND</code> are included for consistency, and to allow reporting of the exception condition if one is encountered.</p></li>
<li><p><strong>Note 2:</strong> The input positional parameter <code>misr_block</code> is recast as type <code>INT</code> on output.</p></li>
</ul></li>
<li><p><strong>Examples:</strong></p>
<pre><code>IDL&gt; rc = chk_misr_block(110, $
   /DEBUG, EXCPT_COND = excpt_cond)
IDL&gt; PRINT, &#39;rc = &#39; + strstr(rc) + &#39;, $
   excpt_cond = &gt;&#39; + excpt_cond + &#39;&lt;&#39;
rc = 0, excpt_cond = &gt;&lt;

IDL&gt; rc = chk_misr_block(0, $
   /DEBUG, EXCPT_COND = excpt_cond)
IDL&gt; PRINT, &#39;rc = &#39; + strstr(rc) + $
   &#39;, excpt_cond = &gt;&#39; + excpt_cond + &#39;&lt;&#39;
rc = 200, excpt_cond = &gt;Error 200 in CHK_MISR_BLOCK:
   Invalid misr_block number: must be within [1, 180].&lt;</code></pre></li>
<li><p><strong>References:</strong> None.</p></li>
<li><p><strong>Versioning:</strong></p>
<ul>
<li><p>2017&#8211;11&#8211;15: Version 0.9 &#8212; Initial release.</p></li>
<li><p>2017&#8211;11&#8211;30: Version 1.0 &#8212; Initial public release.</p></li>
<li><p>2018&#8211;01&#8211;16: Version 1.1 &#8212; Implement optional debugging.</p></li>
<li><p>2018&#8211;06&#8211;01: Version 1.5 &#8212; Implement new coding standards.</p></li>
<li><p>2019&#8211;01&#8211;28: Version 2.00 &#8212; Systematic update of all routines to implement stricter coding standards and improve documentation.</p></li>
<li><p>2019&#8211;08&#8211;20: Version 2.1.0 &#8212; Adopt revised coding and documentation standards (in particular regarding the assignment of numeric return codes), and switch to 3-parts version identifiers.</p></li>
</ul></li>
</ul>
<h2>chk_misr_camera</h2>
<ul>
<li><p><strong>Purpose:</strong> This function checks the validity of the input positional parameter<br />
<code>misr_camera</code>.</p></li>
<li><p><strong>Algorithm:</strong> This function indicates whether the value of the input positional parameter <code>misr_camera</code> is one of <code>[&#8217;DF&#8217;, &#8217;CF&#8217;, &#8217;BF&#8217;, &#8217;AF&#8217;, &#8217;AN&#8217;, &#8217;AA&#8217;, &#8217;BA&#8217;, &#8217;CA&#8217;, &#8217;DA&#8217;]</code>.</p></li>
<li><p><strong>Syntax:</strong> <code>rc = chk_misr_camera(misr_camera, $</code><br />
<code>DEBUG = debug, EXCPT_COND = excp_cond)</code></p></li>
<li><p><strong>Positional parameters [Input/Output]:</strong></p>
<ul>
<li><p><code>misr_camera {STRING} [I/O]:</code> The selected <span class="smallcaps">MISR</span> <span class="smallcaps">Camera</span> name.</p></li>
</ul></li>
<li><p><strong>Keyword parameters [Input/Output]:</strong></p>
<ul>
<li><p><code>DEBUG = debug {INT} [I] (Default value: 0):</code> Flag to activate (<code>1</code>) or skip (<code>0</code>) debugging tests.</p></li>
<li><p><code>EXCPT_COND = excpt_cond {STRING} [O] (Default value: &#8221;):</code> Description of the exception condition if one has been encountered, or a null string otherwise.</p></li>
</ul></li>
<li><p><strong>Returned value type:</strong> <code>INT</code>.</p></li>
<li><p><strong>Outcome:</strong></p>
<ul>
<li><p>If no exception condition has been detected, this function returns <code>0</code>, and the output keyword parameter <code>excpt_cond</code> is set to a null string, if the optional input keyword parameter <code>DEBUG</code> is set and if the optional output keyword parameter <code>EXCPT_COND</code> is provided in the call. Upon exiting this function, the <code>I/O</code> positional parameter <code>misr_camera</code> is a valid properly capitalized <span class="smallcaps">Camera</span> name.</p></li>
<li><p>If an exception condition has been detected, this function returns a non-zero error code, and the output keyword parameter <code>excpt_cond</code> contains a message about the exception condition encountered, if the optional input keyword parameter <code>DEBUG</code> is set and if the optional output keyword parameter <code>EXCPT_COND</code> is provided. The input positional parameter <code>misr_camera</code> is invalid.</p></li>
</ul></li>
<li><p><strong>Exception conditions:</strong></p>
<ul>
<li><p>Error 100: One or more positional parameter(s) are missing.</p></li>
<li><p>Error 110: Input positional parameter <code>misr_camera</code> is not of type <code>STRING</code>.</p></li>
<li><p>Error 120: Input positional parameter <code>misr_camera</code> is not a scalar.</p></li>
<li><p>Error 200: Input positional parameter <code>misr_camera</code> is invalid: must be one of <code>[&#8217;DF&#8217;, &#8217;CF&#8217;, &#8217;BF&#8217;, &#8217;AF&#8217;, &#8217;AN&#8217;, &#8217;AA&#8217;, &#8217;BA&#8217;, &#8217;CA&#8217;, &#8217;DA&#8217;]</code>.</p></li>
</ul></li>
<li><p><strong>Dependencies:</strong></p>
<ul>
<li><p><code>is_scalar.pro</code></p></li>
<li><p><code>is_string.pro</code></p></li>
<li><p><code>set_misr_specs.pro</code></p></li>
<li><p><code>strstr.pro</code></p></li>
</ul></li>
<li><p><strong>Remarks:</strong></p>
<ul>
<li><p><strong>Note 1:</strong> Since the purpose of this function is to check the validity of the input positional parameter <code>misr_camera</code>, all tests are performed irrespective of the setting of the input keyword parameter <code>DEBUG</code>. The keywords <code>DEBUG</code> and <code>EXCPT_COND</code> are included for consistency, and to allow reporting of the exception condition if one is encountered.</p></li>
<li><p><strong>Note 2:</strong> The input positional parameter <code>misr_camera</code> is properly capitalized on output.</p></li>
</ul></li>
<li><p><strong>Examples:</strong></p>
<pre><code>IDL&gt; misr_camera = &#39;aa&#39;
IDL&gt; rc = chk_misr_camera(misr_camera, $
   /DEBUG, EXCPT_COND = excpt_cond)
IDL&gt; PRINT, &#39;rc = &#39; + strstr(rc) + $
   &#39;, excpt_cond = &gt;&#39; + excpt_cond + &#39;&lt;&#39;
rc = 0, excpt_cond = &gt;&lt;
IDL&gt; PRINT, &#39;misr_camera = &#39; + misr_camera
misr_camera = AA

IDL&gt; misr_camera = &#39;xy&#39;
IDL&gt; rc = chk_misr_camera(misr_camera)
IDL&gt; PRINT, &#39;rc = &#39; + strstr(rc)
rc = 200
IDL&gt; PRINT, &#39;misr_camera = &#39; + misr_camera
misr_camera = XY</code></pre></li>
<li><p><strong>References:</strong> None.</p></li>
<li><p><strong>Versioning:</strong></p>
<ul>
<li><p>2017&#8211;11&#8211;15: Version 0.9 &#8212; Initial release.</p></li>
<li><p>2017&#8211;11&#8211;30: Version 1.0 &#8212; Initial public release.</p></li>
<li><p>2018&#8211;01&#8211;16: Version 1.1 &#8212; Implement optional debugging.</p></li>
<li><p>2018&#8211;06&#8211;01: Version 1.5 &#8212; Implement new coding standards.</p></li>
<li><p>2019&#8211;01&#8211;28: Version 2.00 &#8212; Systematic update of all routines to implement stricter coding standards and improve documentation.</p></li>
<li><p>2019&#8211;02&#8211;24: Version 2.01 &#8212; Minor coding and documentation update.</p></li>
<li><p>2019&#8211;08&#8211;20: Version 2.1.0 &#8212; Adopt revised coding and documentation standards (in particular regarding the assignment of numeric return codes), and switch to 3-parts version identifiers.</p></li>
</ul></li>
</ul>
<h2>chk_misr_mode</h2>
<ul>
<li><p><strong>Purpose:</strong> This function checks the validity of the input positional parameter <code>misr_mode</code>.</p></li>
<li><p><strong>Algorithm:</strong> This function indicates whether the value of the input positional parameter <code>misr_mode</code> is one of <code>[&#8217;GM&#8217;, &#8217;LM&#8217;]</code>.</p></li>
<li><p><strong>Syntax:</strong> <code>rc = chk_misr_mode, misr_mode, $</code><br />
<code>DEBUG = debug, EXCPT_COND = excpt_cond)</code></p></li>
<li><p><strong>Positional parameters [Input/Output]:</strong></p>
<ul>
<li><p><code>misr_mode {STRING} [I/O]:</code> The selected <span class="smallcaps">MISR</span> <span class="smallcaps">Mode</span> name.</p></li>
</ul></li>
<li><p><strong>Keyword parameters [Input/Output]:</strong></p>
<ul>
<li><p><code>DEBUG = debug {INT} [I] (Default value: 0):</code> Flag to activate (<code>1</code>) or skip (<code>0</code>) debugging tests.</p></li>
<li><p><code>EXCPT_COND = excpt_cond {STRING} [O] (Default value: &#8221;):</code> Description of the exception condition if one has been encountered, or a null string otherwise.</p></li>
</ul></li>
<li><p><strong>Returned value type:</strong> <code>INT</code>.</p></li>
<li><p><strong>Outcome:</strong></p>
<ul>
<li><p>If no exception condition has been detected, this function returns <code>0</code>, and the output keyword parameter <code>excpt_cond</code> is set to a null string, if the optional input keyword parameter <code>DEBUG</code> is set and if the optional output keyword parameter <code>EXCPT_COND</code> is provided in the call. Upon exiting this function, the <code>I/O</code> positional parameter <code>misr_mode</code> is a valid 2-character upper case <span class="smallcaps">Mode</span> name.</p></li>
<li><p>If an exception condition has been detected, this function returns a non-zero error code, and the output keyword parameter <code>excpt_cond</code> contains a message about the exception condition encountered, if the optional input keyword parameter <code>DEBUG</code> is set and if the optional output keyword parameter <code>EXCPT_COND</code> is provided. The input positional parameter <code>misr_mode</code> is invalid.</p></li>
</ul></li>
<li><p><strong>Exception conditions:</strong></p>
<ul>
<li><p>Error 100: One or more positional parameter(s) are missing.</p></li>
<li><p>Error 110: Input positional parameter <code>misr_mode</code> is not of type <code>STRING</code>.</p></li>
<li><p>Error 120: Input positional parameter <code>misr_mode</code> is not a scalar.</p></li>
<li><p>Error 200: Input positional parameter <code>misr_mode</code> is invalid.</p></li>
</ul></li>
<li><p><strong>Dependencies:</strong></p>
<ul>
<li><p><code>is_scalar.pro</code></p></li>
<li><p><code>is_string.pro</code></p></li>
<li><p><code>set_misr_specs.pro</code></p></li>
<li><p><code>strstr.pro</code></p></li>
</ul></li>
<li><p><strong>Remarks:</strong></p>
<ul>
<li><p><strong>Note 1:</strong> Since the purpose of this function is to check the validity of the input positional parameter <code>misr_mode</code>, all tests are performed irrespective of the setting of the input keyword parameter <code>DEBUG</code>. The keywords <code>DEBUG</code> and <code>EXCPT_COND</code> are included for consistency, and to allow reporting of the exception condition if one is encountered.</p></li>
<li><p><strong>Note 2:</strong> The input positional parameter <code>misr_mode</code> is properly capitalized on output.</p></li>
</ul></li>
<li><p><strong>Examples:</strong></p>
<pre><code>IDL&gt; misr_mode = &#39; gm &#39;
IDL&gt; rc = chk_misr_mode(misr_mode, /DEBUG, EXCPT_COND = excpt_cond)
IDL&gt; PRINT, &#39;rc = &#39; + strstr(rc) + &#39;, excpt_cond = &gt;&#39; + excpt_cond + &#39;&lt;&#39;
rc = 0 and excpt_cond = &gt;&lt;
IDL&gt; PRINT, &#39;misr_mode = &gt;&#39; + misr_mode + &#39;&lt;&#39;
misr_mode = &gt;GM&lt;</code></pre></li>
<li><p><strong>References:</strong> None.</p></li>
<li><p><strong>Versioning:</strong></p>
<ul>
<li><p>2018&#8211;05&#8211;01: Version 0.9 &#8212; Initial release.</p></li>
<li><p>2018&#8211;05&#8211;10: Version 1.0 &#8212; Initial public release.</p></li>
<li><p>2018&#8211;06&#8211;01: Version 1.5 &#8212; Implement new coding standards.</p></li>
<li><p>2019&#8211;01&#8211;28: Version 2.00 &#8212; Systematic update of all routines to implement stricter coding standards and improve documentation.</p></li>
<li><p>2019&#8211;02&#8211;24: Version 2.01 &#8212; Documentation update.</p></li>
<li><p>2019&#8211;08&#8211;20: Version 2.1.0 &#8212; Adopt revised coding and documentation standards (in particular regarding the assignment of numeric return codes), and switch to 3-parts version identifiers.</p></li>
</ul></li>
</ul>
<h2>chk_misr_orbit</h2>
<ul>
<li><p><strong>Purpose:</strong> This function checks the validity of the input positional parameter <code>misr_orbit</code>.</p></li>
<li><p><strong>Algorithm:</strong> This function indicates whether the value of the input positional parameter <code>misr_orbit</code> is within <code>[995L, 200000L]</code>.</p></li>
<li><p><strong>Syntax:</strong> <code>rc = chk_misr_orbit(misr_orbit, $</code><br />
<code>DEBUG = debug, EXCPT_COND = excpt_cond)</code></p></li>
<li><p><strong>Positional parameters [Input/Output]:</strong></p>
<ul>
<li><p><code>misr_orbit {LONG} [I/O]:</code> The selected <span class="smallcaps">MISR</span> <span class="smallcaps">Orbit</span> number.</p></li>
</ul></li>
<li><p><strong>Keyword parameters [Input/Output]:</strong></p>
<ul>
<li><p><code>DEBUG = debug {INT} [I] (Default value: 0):</code> Flag to activate (<code>1</code>) or skip (<code>0</code>) debugging tests.</p></li>
<li><p><code>EXCPT_COND = excpt_cond {STRING} [O] (Default value: &#8221;):</code> Description of the exception condition if one has been encountered, or a null string otherwise.</p></li>
</ul></li>
<li><p><strong>Returned value type:</strong> <code>INT</code>.</p></li>
<li><p><strong>Outcome:</strong></p>
<ul>
<li><p>If no exception condition has been detected, this function returns <code>0</code>, and the output keyword parameter <code>excpt_cond</code> is set to a null string, if the optional input keyword parameter <code>DEBUG</code> is set and if the optional output keyword parameter <code>EXCPT_COND</code> is provided in the call. Upon exiting this function, the <code>I/O</code> positional parameter <code>misr_orbit</code> is a valid <span class="smallcaps">Orbit</span> number.</p></li>
<li><p>If an exception condition has been detected, this function returns a non-zero error code, and the output keyword parameter <code>excpt_cond</code> contains a message about the exception condition encountered, if the optional input keyword parameter <code>DEBUG</code> is set and if the optional output keyword parameter <code>EXCPT_COND</code> is provided. The input positional parameter <code>misr_orbit</code> is invalid.</p></li>
</ul></li>
<li><p><strong>Exception conditions:</strong></p>
<ul>
<li><p>Error 100: One or more positional parameter(s) are missing.</p></li>
<li><p>Error 110: Input positional parameter <code>misr_orbit</code> is not of type numeric.</p></li>
<li><p>Error 120: Input positional parameter <code>misr_orbit</code> is not a scalar.</p></li>
<li><p>Error 200: Input positional parameter <code>misr_orbit</code> is invalid: must be within <code>[995L, 200000L]</code>.</p></li>
</ul></li>
<li><p><strong>Dependencies:</strong></p>
<ul>
<li><p><code>is_scalar.pro</code></p></li>
<li><p><code>is_numeric.pro</code></p></li>
<li><p><code>strstr.pro</code></p></li>
</ul></li>
<li><p><strong>Remarks:</strong></p>
<ul>
<li><p><strong>Note 1:</strong> Since the purpose of this function is to check the validity of the input positional parameter <code>misr_orbit</code>, all tests are performed irrespective of the setting of the input keyword parameter <code>DEBUG</code>. The keywords <code>DEBUG</code> and <code>EXCPT_COND</code> are included for consistency, and to allow reporting of the exception condition if one is encountered.</p></li>
<li><p><strong>Note 2:</strong> The input positional parameter <code>misr_orbit</code> is recast as type <code>LONG</code> on output.</p></li>
</ul></li>
<li><p><strong>Examples:</strong></p>
<pre><code>IDL&gt; rc = chk_misr_orbit(68050L, $
   /DEBUG, EXCPT_COND = excpt_cond)
IDL&gt; PRINT, &#39;rc = &#39; + strstr(rc) + $
   &#39;, excpt_cond = &gt;&#39; + excpt_cond + &#39;&lt;&#39;
rc = 0, excpt_cond = &gt;&lt;

IDL&gt; rc = chk_misr_orbit(100L, $
   /DEBUG, EXCPT_COND = excpt_cond)
IDL&gt; PRINT, &#39;rc = &#39; + strstr(rc) + $
   &#39;, excpt_cond = &gt;&#39; + excpt_cond + &#39;&lt;&#39;
rc = 200, excpt_cond = &gt;Error 200 in CHK_MISR_ORBIT:
Invalid misr_orbit number: must be within [995L, 112000L].&lt;</code></pre></li>
<li><p><strong>References:</strong> None.</p></li>
<li><p><strong>Versioning:</strong></p>
<ul>
<li><p>2017&#8211;11&#8211;15: Version 0.9 &#8212; Initial release.</p></li>
<li><p>2017&#8211;11&#8211;30: Version 1.0 &#8212; Initial public release.</p></li>
<li><p>2018&#8211;01&#8211;16: Version 1.1 &#8212; Implement optional debugging.</p></li>
<li><p>2018&#8211;06&#8211;01: Version 1.5 &#8212; Implement new coding standards.</p></li>
<li><p>2019&#8211;01&#8211;28: Version 2.00 &#8212; Systematic update of all routines to implement stricter coding standards and improve documentation.</p></li>
<li><p>2019&#8211;08&#8211;20: Version 2.1.0 &#8212; Adopt revised coding and documentation standards (in particular regarding the assignment of numeric return codes), and switch to 3-parts version identifiers.</p></li>
</ul></li>
</ul>
<h2>chk_misr_path</h2>
<ul>
<li><p><strong>Purpose:</strong> This function checks the validity of the input positional parameter <code>misr_path</code>.</p></li>
<li><p><strong>Algorithm:</strong> This function indicates whether the value of the input positional parameter <code>misr_path</code> is within <code>[1, 233]</code>.</p></li>
<li><p><strong>Syntax:</strong> <code>rc = chk_misr_path(misr_path, $</code><br />
<code>DEBUG = debug, EXCPT_COND = excpt_cond)</code></p></li>
<li><p><strong>Positional parameters [Input/Output]:</strong></p>
<ul>
<li><p><code>misr_path {INT} [I/O]:</code> The selected <span class="smallcaps">MISR</span> <span class="smallcaps">Path</span> number.</p></li>
</ul></li>
<li><p><strong>Keyword parameters [Input/Output]:</strong></p>
<ul>
<li><p><code>DEBUG = debug {INT} [I] (Default value: 0):</code> Flag to activate (<code>1</code>) or skip (<code>0</code>) debugging tests.</p></li>
<li><p><code>EXCPT_COND = excpt_cond {STRING} [O] (Default value: &#8221;):</code> Description of the exception condition if one has been encountered, or a null string otherwise.</p></li>
</ul></li>
<li><p><strong>Returned value type:</strong> <code>INT</code>.</p></li>
<li><p><strong>Outcome:</strong></p>
<ul>
<li><p>If no exception condition has been detected, this function returns <code>0</code>, and the output keyword parameter <code>excpt_cond</code> is set to a null string, if the optional input keyword parameter <code>DEBUG</code> is set and if the optional output keyword parameter <code>EXCPT_COND</code> is provided in the call. Upon exiting this function, the <code>I/O</code> positional parameter <code>misr_path</code> is a valid <span class="smallcaps">Path</span> number.</p></li>
<li><p>If an exception condition has been detected, this function returns a non-zero error code, and the output keyword parameter <code>excpt_cond</code> contains a message about the exception condition encountered, if the optional input keyword parameter <code>DEBUG</code> is set and if the optional output keyword parameter <code>EXCPT_COND</code> is provided. The input positional parameter <code>misr_path</code> is invalid.</p></li>
</ul></li>
<li><p><strong>Exception conditions:</strong></p>
<ul>
<li><p>Error 100: One or more positional parameter(s) are missing.</p></li>
<li><p>Error 110: Input positional parameter <code>misr_path</code> is not of type numeric.</p></li>
<li><p>Error 120: Input positional parameter <code>misr_path</code> is not a scalar.</p></li>
<li><p>Error 200: Input positional parameter <code>misr_path</code> is invalid: must be within <code>[1, 233]</code>.</p></li>
</ul></li>
<li><p><strong>Dependencies:</strong></p>
<ul>
<li><p><code>is_scalar.pro</code></p></li>
<li><p><code>is_numeric.pro</code></p></li>
<li><p><code>strstr.pro</code></p></li>
</ul></li>
<li><p><strong>Remarks:</strong></p>
<ul>
<li><p><strong>Note 1:</strong> Since the purpose of this function is to check the validity of the input positional parameter <code>misr_path</code>, all tests are performed irrespective of the setting of the input keyword parameter <code>DEBUG</code>. The keywords <code>DEBUG</code> and <code>EXCPT_COND</code> are included for consistency, and to allow reporting of the exception condition if one is encountered.</p></li>
<li><p><strong>Note 2:</strong> The input positional parameter <code>misr_path</code> is recast as type <code>INT</code> on output.</p></li>
</ul></li>
<li><p><strong>Examples:</strong></p>
<pre><code>IDL&gt; rc = chk_misr_path(168, $
   /DEBUG, EXCPT_COND = excpt_cond)
IDL&gt; PRINT, &#39;rc = &#39; + strstr(rc) + $
   &#39;, excpt_cond = &gt;&#39; + excpt_cond + &#39;&lt;&#39;
rc = 0, excpt_cond = &gt;&lt;

IDL&gt; rc = chk_misr_path(368, $
   /DEBUG, EXCPT_COND = excpt_cond)
IDL&gt; PRINT, &#39;rc = &#39; + strstr(rc) + $
   &#39;, excpt_cond = &gt;&#39; + excpt_cond + &#39;&lt;&#39;
rc = 200, excpt_cond = &gt;Error 200 in CHK_MISR_PATH:
Invalid misr_path number: must be within [1, 233].&lt;</code></pre></li>
<li><p><strong>References:</strong> None.</p></li>
<li><p><strong>Versioning:</strong></p>
<ul>
<li><p>2017&#8211;11&#8211;15: Version 0.9 &#8212; Initial release.</p></li>
<li><p>2017&#8211;11&#8211;30: Version 1.0 &#8212; Initial public release.</p></li>
<li><p>2018&#8211;01&#8211;16: Version 1.1 &#8212; Implement optional debugging.</p></li>
<li><p>2018&#8211;06&#8211;01: Version 1.5 &#8212; Implement new coding standards.</p></li>
<li><p>2019&#8211;01&#8211;28: Version 2.00 &#8212; Systematic update of all routines to implement stricter coding standards and improve documentation.</p></li>
<li><p>2019&#8211;08&#8211;20: Version 2.1.0 &#8212; Adopt revised coding and documentation standards (in particular regarding the assignment of numeric return codes), and switch to 3-parts version identifiers.</p></li>
</ul></li>
</ul>
<h2>chk_misr_resol</h2>
<ul>
<li><p><strong>Purpose:</strong> This function checks the validity of the input positional parameter <code>misr_resol</code>.</p></li>
<li><p><strong>Algorithm:</strong> This function indicates whether the value of the input positional parameter <code>misr_resol</code> is either <code>275</code> or <code>1100</code>.</p></li>
<li><p><strong>Syntax:</strong> <code>rc = chk_misr_resol(misr_resol, $</code><br />
<code>DEBUG = debug, EXCPT_COND = excpt_cond)</code></p></li>
<li><p><strong>Positional parameters [Input/Output]:</strong></p>
<ul>
<li><p><code>misr_resol {INT} [I]:</code> The selected <span class="smallcaps">MISR</span> spatial resolution.</p></li>
</ul></li>
<li><p><strong>Keyword parameters [Input/Output]:</strong></p>
<ul>
<li><p><code>DEBUG = debug {INT} [I] (Default value: 0):</code> Flag to activate (<code>1</code>) or skip (<code>0</code>) debugging tests.</p></li>
<li><p><code>EXCPT_COND = excpt_cond {STRING} [O] (Default value: &#8221;):</code> Description of the exception condition if one has been encountered, or a null string otherwise.</p></li>
</ul></li>
<li><p><strong>Returned value type:</strong> <code>INT</code>.</p></li>
<li><p><strong>Outcome:</strong></p>
<ul>
<li><p>If no exception condition has been detected, this function returns <code>0</code>, and the output keyword parameter <code>excpt_cond</code> is set to a null string, if the optional input keyword parameter <code>DEBUG</code> is set and if the optional output keyword parameter <code>EXCPT_COND</code> is provided in the call. The input positional parameter <code>misr_resol</code> is valid.</p></li>
<li><p>If an exception condition has been detected, this function returns a non-zero error code, and the output keyword parameter <code>excpt_cond</code> contains a message about the exception condition encountered, if the optional input keyword parameter <code>DEBUG</code> is set and if the optional output keyword parameter <code>EXCPT_COND</code> is provided. The input positional parameter <code>misr_resol</code> is invalid.</p></li>
</ul></li>
<li><p><strong>Exception conditions:</strong></p>
<ul>
<li><p>Error 100: One or more positional parameter(s) are missing.</p></li>
<li><p>Error 110: Input positional parameter <code>misr_resol</code> is not of type numeric.</p></li>
<li><p>Error 120: Input positional parameter <code>misr_resol</code> is not a scalar.</p></li>
<li><p>Error 200: Input positional parameter <code>misr_resol</code> is invalid: must be either <code>275</code> or <code>1100</code>.</p></li>
</ul></li>
<li><p><strong>Dependencies:</strong></p>
<ul>
<li><p><code>is_numeric.pro</code></p></li>
<li><p><code>is_scalar.pro</code></p></li>
<li><p><code>strstr.pro</code></p></li>
</ul></li>
<li><p><strong>Remarks:</strong></p>
<ul>
<li><p><strong>Note 1:</strong> Since the purpose of this function is to check the validity of the input positional parameter <code>misr_resol</code>, all tests are performed irrespective of the setting of the input keyword parameter <code>DEBUG</code>. The keywords <code>DEBUG</code> and <code>EXCPT_COND</code> are included for consistency, and to allow reporting of the exception condition if one is encountered.</p></li>
<li><p><strong>Note 2:</strong> The input positional parameter <code>misr_resol</code> is recast as type <code>INT</code> on output.</p></li>
</ul></li>
<li><p><strong>Examples:</strong></p>
<pre><code>IDL&gt; rc = chk_misr_resol(275, $
   /DEBUG, EXCPT_COND = excpt_cond)
IDL&gt; PRINT, &#39;rc = &#39; + strstr(rc) + &#39;, $
   excpt_cond = &gt;&#39; + excpt_cond + &#39;&lt;&#39;
rc = 0, excpt_cond = &gt;&lt;

IDL&gt; rc = chk_misr_resol(0, $
   /DEBUG, EXCPT_COND = excpt_cond)
IDL&gt; PRINT, &#39;rc = &#39; + strstr(rc) + $
   &#39;, excpt_cond = &gt;&#39; + excpt_cond + &#39;&lt;&#39;
rc = 200, excpt_cond = &gt;Error 200 in CHK_MISR_resol:
   Invalid misr_resol number: must be either 275 or 1100.&lt;</code></pre></li>
<li><p><strong>References:</strong> None.</p></li>
<li><p><strong>Versioning:</strong></p>
<ul>
<li><p>2017&#8211;11&#8211;15: Version 0.9 &#8212; Initial release.</p></li>
<li><p>2017&#8211;11&#8211;30: Version 1.0 &#8212; Initial public release.</p></li>
<li><p>2018&#8211;01&#8211;16: Version 1.1 &#8212; Implement optional debugging.</p></li>
<li><p>2018&#8211;06&#8211;01: Version 1.5 &#8212; Implement new coding standards.</p></li>
<li><p>2019&#8211;01&#8211;28: Version 2.00 &#8212; Systematic update of all routines to implement stricter coding standards and improve documentation.</p></li>
<li><p>2019&#8211;02&#8211;28: Version 2.01 &#8212; Documentation update.</p></li>
<li><p>2019&#8211;08&#8211;20: Version 2.1.0 &#8212; Adopt revised coding and documentation standards (in particular regarding the assignment of numeric return codes), and switch to 3-parts version identifiers.</p></li>
</ul></li>
</ul>
<h2>find_orbits_paths_dates</h2>
<ul>
<li><p><strong>Purpose:</strong> This function returns a structure containing the <span class="smallcaps">MISR</span> <span class="smallcaps">Orbit</span>s belonging to the <span class="smallcaps">MISR</span> <span class="smallcaps">Path</span>s in the range <code>misr_path_1</code> to <code>misr_path_2</code> and between the dates <code>date_1</code> and <code>date_2</code>.</p></li>
<li><p><strong>Algorithm:</strong> This function relies on the <span class="smallcaps">MISR</span> <span class="smallcaps">Toolkit</span> function<br />
<code>MTK_PATH_TIMERANGE_TO_ORBITLIST</code> to deliver the required information.</p></li>
<li><p><strong>Syntax:</strong> <code>rc = find_orbits_paths_dates (misr_path_1, misr_path_2, $</code><br />
<code>date_1, date_2, misr_orbits, DEBUG = debug, EXCPT_COND = excpt_cond)</code></p></li>
<li><p><strong>Positional parameters [Input/Output]:</strong></p>
<ul>
<li><p><code>misr_path_1 {INT} [I] (Default value: None):</code> The first <span class="smallcaps">MISR</span> <span class="smallcaps">Path</span> to be considered.</p></li>
<li><p><code>misr_path_2 {INT} [I] (Default value: None):</code> The last <span class="smallcaps">MISR</span> <span class="smallcaps">Path</span> to be considered.</p></li>
<li><p><code>date_1 {STRING} [I/O] (Default value: None):</code> The first date to be considered, formatted as <code>YYYY-MM-DD</code>, where <code>YYYY</code>, <code>MM</code> and <code>DD</code> are the year, month and day numbers. Upon successful return, this date is formatted as <code>YYYY-MM-DDT00:00:00Z</code>.</p></li>
<li><p><code>date_2 {STRING} [I/O] (Default value: None):</code> The last date to be considered, formatted as <code>YYYY-MM-DD</code>, where <code>YYYY</code>, <code>MM</code> and <code>DD</code> are the year, month and day numbers. Upon successful return, this date is formatted as <code>YYYY-MM-DDT23:59:59Z</code>.</p></li>
<li><p><code>misr_orbits {STRUCTURE} [O]:</code> A structure containing the <span class="smallcaps">MISR</span> <span class="smallcaps">Orbit</span>s belonging to each <span class="smallcaps">Path</span> within the range <code>[misr_path_1, misr_path_2]</code> and acquired in the time period <code>[date_1, date_2]</code>.</p></li>
</ul></li>
<li><p><strong>Keyword parameters [Input/Output]:</strong></p>
<ul>
<li><p><code>DEBUG = debug {INT} [I] (Default value: 0):</code> Flag to activate (<code>1</code>) or skip (<code>0</code>) debugging tests.</p></li>
<li><p><code>EXCPT_COND = excpt_cond {STRING} [O] (Default value: &#8221;):</code> Description of the exception condition if one has been encountered, or a null string otherwise.</p></li>
</ul></li>
<li><p><strong>Returned value type:</strong> <code>INT</code>.</p></li>
<li><p><strong>Outcome:</strong></p>
<ul>
<li><p>If no exception condition has been detected, this function returns <code>0</code>, and the output keyword parameter <code>excpt_cond</code> is set to a null string, if the optional input keyword parameter <code>DEBUG</code> was set and if the optional output keyword parameter <code>EXCPT_COND</code> was provided in the call. The output positional parameter <code>misr_orbits</code> is a stucture containing a list of the <span class="smallcaps">MISR</span> <span class="smallcaps">Orbits</span> belonging to the <span class="smallcaps">Paths</span> in the range <code>misr_path_1</code> to <code>misr_path_2</code> and between the dates <code>date_1</code> and <code>date_2</code>.</p></li>
<li><p>If an exception condition has been detected, this function returns a non-zero error code, and the output keyword parameter <code>excpt_cond</code> contains a message about the exception condition encountered, if the optional input keyword parameter <code>DEBUG</code> is set and if the optional output keyword parameter <code>EXCPT_COND</code> is provided. The output positional parameter <code>misr_orbits</code> is a stucture that may be empty, incomplete or useless.</p></li>
</ul></li>
<li><p><strong>Exception conditions:</strong></p>
<ul>
<li><p>Error 100: One or more positional parameter(s) are missing.</p></li>
<li><p>Error 110: Positional parameter <code>misr_path_1</code> is invalid.</p></li>
<li><p>Error 120: Positional parameter <code>misr_path_2</code> is invalid.</p></li>
<li><p>Error 130: Positional parameter <code>date_1</code> is invalid.</p></li>
<li><p>Error 140: Positional parameter <code>date_2</code> is invalid.</p></li>
<li><p>Error 600: An exception condition occurred in the <span class="smallcaps">MISR</span> <span class="smallcaps">Toolkit</span> routine<br />
<code>MTK_PATH_TIMERANGE_TO_ORBITLIST</code>.</p></li>
</ul></li>
<li><p><strong>Dependencies:</strong></p>
<ul>
<li><p><code>chk_ymddate.pro</code></p></li>
<li><p><code>chk_misr_path.pro</code></p></li>
<li><p><code>strstr.pro</code></p></li>
</ul></li>
<li><p><strong>Remarks:</strong></p>
<ul>
<li><p><strong>Note 1:</strong> This function returns information on the <span class="smallcaps">Orbit</span>s that are theoretically available within the specified <span class="smallcaps">Path</span>s and between the given dates. Data for those <span class="smallcaps">Orbit</span>s may not be available at all if there was a technical problem on the platform, or may not be available locally if they have not been explicitly downloaded from the NASA Langley DAAC. Similarly, this function does not report on the eventual availability of partially available <span class="smallcaps">Orbit</span>s or of subsetted data files.</p></li>
<li><p><strong>Note 2:</strong> The input argument <code>misr_path_1</code> is deemed smaller than <code>misr_path_2</code>; however, if this is not the case, the values of the two <span class="smallcaps">Paths</span> are interchanged.</p></li>
<li><p><strong>Note 3:</strong> Similarly, the input arguments <code>date_1</code> and <code>date_2</code> are expected to be given in chronological order; however, if this is not the case, the values of the two dates are interchanged.</p></li>
<li><p><strong>Note 4:</strong> The positional parameters <code>date_1</code> and <code>date_2</code> are both expected to be provided as <code>STRING</code>s formatted as <code>YYYY-MM-DD</code> on input, and are reformatted as <code>YYYY-MM-DDT00:00:00Z</code> on output, as required by the <span class="smallcaps">MISR</span> <span class="smallcaps">Toolkit</span>.</p></li>
</ul></li>
<li><p><strong>Examples:</strong></p>
<pre><code>IDL&gt; misr_path_1 = 168
IDL&gt; misr_path_2 = 169
IDL&gt; date_1 = &#39;2010-01-01&#39;
IDL&gt; date_2 = &#39;2010-01-31&#39;
IDL&gt; rc = find_orbits_paths_dates(misr_path_1, misr_path_2, $
   date_1, date_2, misr_orbits, /DEBUG, EXCPT_COND = excpt_cond)
IDL&gt; PRINT, &#39;rc = &#39;, rc, &#39; and excpt_cond = &gt;&#39; + excpt_cond + &#39;&lt;&#39;
rc =        0 and excpt_cond = &gt;&lt;
IDL&gt; HELP, misr_orbits
** Structure &lt;1abeedc8&gt;, 8 tags, length=40, data length=38, refs=1:
   TITLE           STRING    &#39;MISR_Orbits&#39;
   N_MISR_PATHS    INT              2
   MISR_PATH_168   INT            168
   MISR_PATH_168_ORBIT_0
                   LONG             53604
   MISR_PATH_168_ORBIT_1
                   LONG             53837
   MISR_PATH_169   INT            169
   MISR_PATH_169_ORBIT_0
                   LONG             53473
   MISR_PATH_169_ORBIT_1
                   LONG             53706
IDL&gt; PRINT, misr_orbits
{ MISR_Orbits 2 168 53604 53837 169 53473 53706}</code></pre></li>
<li><p><strong>References:</strong> None.</p></li>
<li><p><strong>Versioning:</strong></p>
<ul>
<li><p>2017&#8211;09&#8211;07: Version 0.9 &#8212; Initial release.</p></li>
<li><p>2017&#8211;11&#8211;30: Version 1.0 &#8212; Initial public release.</p></li>
<li><p>2018&#8211;01&#8211;16: Version 1.1 &#8212; Implement optional debugging.</p></li>
<li><p>2018&#8211;06&#8211;01: Version 1.5 &#8212; Implement new coding standards.</p></li>
<li><p>2018&#8211;08&#8211;21: Version 1.6 &#8212; Documentation update.</p></li>
<li><p>2019&#8211;01&#8211;28: Version 2.00 &#8212; Systematic update of all routines to implement stricter coding standards and improve documentation.</p></li>
<li><p>2019&#8211;04&#8211;04: Version 2.01 &#8212; Bug fix: Use the new function <code>chk_ymddate.pro</code> instead of the old function <code>chk_date_ymd.pro</code>.</p></li>
<li><p>2019&#8211;04&#8211;04: Version 2.02 &#8212; Update the output structure to report on the number of <span class="smallcaps">Orbits</span> found in each <span class="smallcaps">Path</span>, and to include the list of <span class="smallcaps">Orbits</span> as an array rather than individual items.</p></li>
<li><p>2019&#8211;05&#8211;04: Version 2.03 &#8212; Update the code to report the specific error message of MTK routines.</p></li>
<li><p>2019&#8211;08&#8211;20: Version 2.1.0 &#8212; Adopt revised coding and documentation standards (in particular regarding the assignment of numeric return codes), and switch to 3-parts version identifiers.</p></li>
</ul></li>
</ul>
<h2>fn2mpocbv</h2>
<ul>
<li><p><strong>Purpose:</strong> This function extracts metadata on the <span class="smallcaps">MISR</span> or <span class="smallcaps">MISR-HR</span> <span class="smallcaps">Mode</span>, <span class="smallcaps">Path</span>, <span class="smallcaps">Orbit</span>, <span class="smallcaps">Camera</span>, <span class="smallcaps">Block</span> and <span class="smallcaps">Version</span> identifiers from the file specification <span class="smallcaps">filespec</span>.</p></li>
<li><p><strong>Algorithm:</strong> This function is designed to work with standard <span class="smallcaps">MISR</span> and <span class="smallcaps">MISR-HR</span> filenames, such as the <span class="smallcaps">L1B2</span> Radiance, RCCM, RPV or TIP products (but may work with other filenames, or even arbitrary text strings), as long as they include string patterns of the following types:</p>
<ul>
<li><p><code>&lt;mM&gt;</code>, where <code>m</code> is either <code>G</code> or <code>L</code>, designating the <code>misr_mode_id</code>,</p></li>
<li><p><code>&lt;Pxxx&gt;</code>, where <code>xxx</code> is a 3-digit string, designating the <code>misr_path_id</code>,</p></li>
<li><p><code>&lt;Oyyyyyy&gt;</code>, where <code>yyyyyy</code> is a 6-digit string, designating the <code>misr_orbit_id</code>,</p></li>
<li><p><code>&lt;cc&gt;</code>, where <code>cc</code> is a 2-character string, designating the <code>misr_camera_id</code>,</p></li>
<li><p><code>&lt;Bzzz&gt;</code>, where <code>zzz</code> is a 3-digit string, designating the <code>misr_block_id</code>,</p></li>
<li><p><code>&lt;Fnn_nnnn&gt;</code>, where <code>nn</code> and <code>nnnn</code> are 2- and 4-digit strings, respectively, designating the <code>misr_version_id</code>,</p></li>
<li><p><code>&lt;Vmm.mm-mm&gt;</code>, where <code>mm</code> are numeric strings, designating the <code>misrhr_version_id</code>,</p></li>
</ul>
<p>and where the symbols <code>&lt;</code> and <code>&gt;</code> stand for either the underscore (<code>_</code>), the dash (<code>-</code>) or the full stop (<code>.</code>) separator. If any one of these string patterns is missing in <span class="smallcaps">filespec</span>, the corresponding output identifer is set to a null string.</p></li>
<li><p><strong>Syntax:</strong> <code>rc = fn2mpocbv(filespec, misr_mode_id, misr_path_id, $</code><br />
<code>misr_orbit_id, misr_camera_id, misr_block_id, $</code><br />
<code>misr_version_id, misrhr_version_id, $</code><br />
<code>DEBUG = debug, EXCPT_COND = excpt_cond)</code></p></li>
<li><p><strong>Positional parameters [Input/Output]:</strong></p>
<ul>
<li><p><code>filespec {STRING} [I]:</code> An arbitrary character string, typically the filename of a <span class="smallcaps">MISR</span> data file or <span class="smallcaps">MISR-HR</span> product file.</p></li>
<li><p><code>misr_mode_id {STRING} [O]:</code> The <span class="smallcaps">Mode</span> identifer.</p></li>
<li><p><code>misr_path_id {INTEGER} [O]:</code> The <span class="smallcaps">MISR</span> <span class="smallcaps">Path</span> identifer.</p></li>
<li><p><code>misr_orbit_id {LONG} [O]:</code> The <span class="smallcaps">MISR</span> <span class="smallcaps">Orbit</span> identifer.</p></li>
<li><p><code>misr_camera_id {STRING} [O]:</code> The <span class="smallcaps">MISR</span> <span class="smallcaps">Camera</span> identifer.</p></li>
<li><p><code>misr_block_id {STRING} [O]:</code> The <span class="smallcaps">MISR</span> <span class="smallcaps">Block</span> identifer.</p></li>
<li><p><code>misr_version_id STRING [O]:</code> The <span class="smallcaps">MISR</span> <span class="smallcaps">Version</span> identifer.</p></li>
</ul></li>
<li><p><strong>Keyword parameters [Input/Output]:</strong></p>
<ul>
<li><p><code>DEBUG = debug {INT} [I] (Default value: 0):</code> Flag to activate (<code>1</code>) or skip (<code>0</code>) debugging tests.</p></li>
<li><p><code>EXCPT_COND = excpt_cond {STRING} [O] (Default value: &#8221;):</code> Description of the exception condition if one has been encountered, or a null string otherwise.</p></li>
</ul></li>
<li><p><strong>Returned value type:</strong> <code>INT</code>.</p></li>
<li><p><strong>Outcome:</strong></p>
<ul>
<li><p>If no exception condition has been detected, this function returns <code>0</code>, and the output keyword parameter <code>excpt_cond</code> is set to a null string, if the optional input keyword parameter <code>DEBUG</code> was set and if the optional output keyword parameter <code>EXCPT_COND</code> was provided in the call. The output arguments <code>misr_mode_id</code>, <code>misr_path_id</code>, <code>misr_orbit_id</code>,<br />
<code>misr_camera_id</code>, <code>misr_block_id</code>, <code>misr_version_id</code> and <code>misrhr_version_id</code> contain the desired information.</p></li>
<li><p>If an exception condition has been detected, this function returns a non-zero error code, and the output keyword parameter <code>excpt_cond</code> contains a message about the exception condition encountered, if the optional input keyword parameter <code>DEBUG</code> is set and if the optional output keyword parameter <code>EXCPT_COND</code> is provided. The output arguments <code>misr_mode_id</code>, <code>misr_path_id</code>, <code>misr_orbit_id</code>, <code>misr_camera_id</code>, <code>misr_block_id</code>, <code>misr_version_id</code> and <code>misrhr_version_id</code> may be undefined, incomplete or useless.</p></li>
</ul></li>
<li><p><strong>Exception conditions:</strong></p>
<ul>
<li><p>Error 100: One or more positional parameter(s) are missing.</p></li>
<li><p>Error 110: Input positional parameter <code>filespec</code> is not of type <code>STRING</code>.</p></li>
</ul></li>
<li><p><strong>Dependencies:</strong></p>
<ul>
<li><p><code>is_string.pro</code></p></li>
<li><p><code>last_char.pro</code></p></li>
<li><p><code>strstr.pro</code></p></li>
</ul></li>
<li><p><strong>Remarks:</strong></p>
<ul>
<li><p><strong>Note 1:</strong> It is highly recommended to call this function with specific output positional parameter names such as <code>misr_mode_id</code>, <code>misr_path_id</code>, etc., to avoid interfering with values possibly already set in the calling routine.</p></li>
<li><p><strong>Note 2:</strong> If the input positional parameter <code>filespec</code> contains multiple instances of these string patterns, the last one encountered, when scanning <code>filespec</code> from left to right, sets the definitive value of the output parameter.</p></li>
<li><p><strong>Note 3:</strong> This function does not check the existence or the readability of the presumed input positional parameter <code>filespec</code>, so that file does not need to be accessible or even match an actual file: See the last example below.</p></li>
</ul></li>
<li><p><strong>Examples:</strong></p>
<pre><code>IDL&gt; filespec = &#39;/Volumes/MISR_Data3&#8297;/P168&#8297;/L1_GM&#8297;/
   MISR_AM1_GRP_TERRAIN_GM_P168_O005839_DA_F03_0024.hdf&#39;
IDL&gt; rc = fn2mpocbv(filespec, misr_mode_id, $
   misr_path_id, misr_orbit_id, misr_camera_id, $
   misr_block_id, misr_version_id, misrhr_version_id, $
   DEBUG = debug, EXCPT_COND = excpt_cond)
IDL&gt; PRINT, &#39;misr_mode_id = &gt;&#39; + misr_mode_id + &#39;&lt;&#39;
misr_mode_id = &gt;GM&lt;
IDL&gt; PRINT, &#39;misr_path_id = &gt;&#39; + misr_path_id + &#39;&lt;&#39;
misr_path_id = &gt;P168&lt;
IDL&gt; PRINT, &#39;misr_orbit_id = &gt;&#39; + misr_orbit_id + &#39;&lt;&#39;
misr_orbit_id = &gt;O005839&lt;
IDL&gt; PRINT, &#39;misr_camera_id = &gt;&#39; + misr_camera_id + &#39;&lt;&#39;
misr_camera_id = &gt;DA&lt;
IDL&gt; PRINT, &#39;misr_block_id = &gt;&#39; + misr_block_id + &#39;&lt;&#39;
misr_block_id = &gt;&lt;
IDL&gt; PRINT, &#39;misr_version_id = &gt;&#39; + misr_version_id + &#39;&lt;&#39;
misr_version_id = &gt;F03_0024&lt;
IDL&gt; PRINT, &#39;misrhr_version_id = &gt;&#39; + misrhr_version_id + &#39;&lt;&#39;
misrhr_version_id = &gt;&lt;

IDL&gt; filespec = &#39;File_P190-O068050.B110-GM_test.AF&#39;
IDL&gt; rc = fn2mpocbv(filespec, misr_mode_id, misr_path_id, misr_orbit_id, misr_camera_id, misr_block_id, misr_version_id, misrhr_version_id)
IDL&gt; PRINT, &#39;misr_mode_id = &gt;&#39; + misr_mode_id + &#39;&lt;&#39;
misr_mode_id = &gt;GM&lt;
IDL&gt; PRINT, &#39;misr_path_id = &gt;&#39; + misr_path_id + &#39;&lt;&#39;
misr_path_id = &gt;P190&lt;
IDL&gt; PRINT, &#39;misr_orbit_id = &gt;&#39; + misr_orbit_id + &#39;&lt;&#39;
misr_orbit_id = &gt;O068050&lt;
IDL&gt; PRINT, &#39;misr_camera_id = &gt;&#39; + misr_camera_id + &#39;&lt;&#39;
misr_camera_id = &gt;AF&lt;
IDL&gt; PRINT, &#39;misr_block_id = &gt;&#39; + misr_block_id + &#39;&lt;&#39;
misr_block_id = &gt;B110&lt;
IDL&gt; PRINT, &#39;misr_version_id = &gt;&#39; + misr_version_id + &#39;&lt;&#39;
misr_version_id = &gt;&lt;
IDL&gt; PRINT, &#39;misrhr_version_id = &gt;&#39; + misrhr_version_id + &#39;&lt;&#39;
misrhr_version_id = &gt;&lt;</code></pre></li>
<li><p><strong>References:</strong> None.</p></li>
<li><p><strong>Versioning:</strong></p>
<ul>
<li><p>2017&#8211;09&#8211;03: Version 0.9 &#8212; Initial release under the name <code>fn2pocv_l1b2_gm.pro</code>.</p></li>
<li><p>2018&#8211;01&#8211;30: Version 1.0 &#8212; Initial public release.</p></li>
<li><p>2018&#8211;05&#8211;07: Version 1.1 &#8212; Add the <code>misr_mode</code> output positional parameter, merge this function with its twin <code>fn2pocv_l1b2_lm.pro</code> and change the name to<br />
<code>fn2mpocv_l1b2.pro</code>.</p></li>
<li><p>2018&#8211;05&#8211;18: Version 1.5 &#8212; Implement new coding standards.</p></li>
<li><p>2018&#8211;07&#8211;13: Version 1.6 &#8212; Modify the code to ensure that the output variable <code>misr_camera</code> is a scalar string and update the documentation.</p></li>
<li><p>2019&#8211;02&#8211;26: Version 1.7 &#8212; Generalize the applicability of this function by extracting the <span class="smallcaps">MISR</span> <span class="smallcaps">Mode</span>, <span class="smallcaps">Path</span>, <span class="smallcaps">Orbit</span>, <span class="smallcaps">Camera</span>, <span class="smallcaps">Block</span> and <span class="smallcaps">Version</span> identifiers on the basis of string patterns rather than relying on <span class="smallcaps">MISR</span> Toolkit, change its name from <code>fn2mpocv_l1b2.pro</code> to<code>fn2mpocbv.pro</code> and move this function to the <span class="smallcaps">MISR_Tools</span> repository.</p></li>
<li><p>2019&#8211;03&#8211;01: Version 2.00 &#8212; Systematic update of all routines to implement stricter coding standards and improve documentation.</p></li>
<li><p>2019&#8211;08&#8211;20: Version 2.1.0 &#8212; Adopt revised coding and documentation standards (in particular regarding the assignment of numeric return codes), and switch to 3-parts version identifiers.</p></li>
</ul></li>
</ul>
<h2>hr2lr</h2>
<ul>
<li><p><strong>Purpose:</strong> This function downsizes the high spatial resolution (<span class="math inline">2048&#8197;&#215;&#8197;512</span>) input positional parameter <code>inarray</code> by a factor 4 in each dimension, to the reduced spatial resolution (<span class="math inline">512&#8197;&#215;&#8197;128</span>) output array, and returns the latter to the calling routine. The algorithm used depends on the value of input positional parameter <code>innature</code>.</p></li>
<li><p><strong>Algorithm:</strong> If the input positional parameter <code>inarray</code> contains radiance or reflectance data at the full (native) spatial resolution of the <span class="smallcaps">MISR</span> instrument, this function simulates the averaging taking place on-board the Terra platform for the 24 non-red data channels of the Global Mode off-nadir cameras. This function can also be used to downsize other arrays, such as <span class="smallcaps">RDQI</span> or land cover masks. The downscaling algorithm analyzes successive, non-overlapping subwindows of <span class="math inline">4&#8197;&#215;&#8197;4</span> pixels in the input array. If this subwindow is identified as<br />
<code>subarray = inarray[ii:ii + 3, jj:jj + 3]</code><br />
where <code>ii</code> and <code>jj</code> are the indices in the input high spatial resolution array, then the corresponding value in the output low spatial resolution array is set as follows, depending on the value of the input positional parameter <code>innature</code>:</p>
<ul>
<li><p>If <code>innature = &#8217;RDQI&#8217;</code> and the input array <code>inarray</code> is of type <code>BYTE</code>, the algorithm assumes that it contains <span class="smallcaps">RDQI</span> data, where values range within <code>[0B, 3B]</code>. The <span class="smallcaps">RDQI</span> values of the low resolution output array are set to the <strong>largest</strong> <span class="smallcaps">RDQI</span> value found among the 16 samples of each subwindow:<br />
<code>outarray[i, j] = MAX(subarray)</code>.</p></li>
<li><p>If <code>innature = &#8217;Mask&#8217;</code> and the input array <code>inarray</code> is of type <code>BYTE</code>, the algorithm assumes that it contains a land, water and cloud mask, where values range within <code>[1B, 254B]</code>, and where usable values are within <code>[1B, 3B]</code>. The mask values of the low resolution output array are set to the <strong>most frequent</strong> usable value found among the 16 samples of each subwindow, unless there are more obscured or edge values than usable values. If two mask categories contain the same largest number of values, the one with the greatest value prevails.</p></li>
<li><p>If <code>innature = &#8217;Radrd&#8217;</code> and the input array <code>inarray</code> is of type <code>UINT</code>, the algorithm assumes that it contains L1B2 <span class="smallcaps">scaled Radiance</span> data, with the <span class="smallcaps">RDQI</span> attached, where values range within <code>[0U, 65535U]</code>, and where usable values are within <code>]0U, 65507U]</code>. The <span class="smallcaps">scaled Radiance</span> values of the low resolution output array are set to the <strong>mean value</strong> of the usable (non-zero) <span class="smallcaps">scaled Radiance</span>s (without the <span class="smallcaps">RDQI</span> attached) found among the 16 samples of each subwindow:<br />
<code>outarray[i, j] = MEAN(subarray[good])</code>, where <code>subarray[good]</code> stands for the usable values in the subwindow, with the maximum <span class="smallcaps">RDQI</span> value attached. If all values of the subwindow are unusable, the low resolution output array value is set to the largest <code>UINT</code> found within that subwindow.</p></li>
<li><p>If <code>innature = &#8217;Rad&#8217;</code> and the input array <code>inarray</code> is of type <code>FLOAT</code>, the algorithm assumes that it contains <span class="smallcaps">unscaled Radiance</span> data, which can only take on usable values within the range <code>]0.0, 800.0]</code> [<span class="math inline"><em>W</em><em>m</em><sup>&#8197;&#8722;&#8197;2</sup><em>s</em><em>r</em><sup>&#8197;&#8722;&#8197;1</sup><em>&#956;</em><em>m</em><sup>&#8197;&#8722;&#8197;1</sup></span>]. The <span class="smallcaps">unscaled Radiance</span> values of the low resolution output array are set to the <strong>mean value</strong> of the usable (non-zero) <span class="smallcaps">unscaled Radiance</span>s found among the 16 samples of each subwindow:<br />
<code>outarray[i, j] = MEAN(subarray[good])</code>, where <code>subarray[good]</code> stands for the usable values in the subwindow. If all values of the subwindow are unusable, the low resolution output array value is set to <code>0.0</code>.</p></li>
<li><p>If <code>innature = &#8217;Brf&#8217;</code> and the input array <code>inarray</code> is of type <code>FLOAT</code>, the algorithm assumes that it contains L1B2 Bidirectional reflectance factor (<span class="smallcaps">Brf</span>) data, which can only take on usable values within the range <code>]0.0, 2.0]</code>. The <span class="smallcaps">Brf</span> values of the low resolution output array are set to the <strong>mean value</strong> of the usable (non-zero) <span class="smallcaps">Brf</span>s found among the 16 samples of each subwindow:<br />
<code>outarray[i, j] = MEAN(subarray[good])</code>, where <code>subarray[good]</code> stands for the usable values in the subwindow. If all values of the subwindow are unusable, the low resolution output array value is set to <code>0.0</code>.</p></li>
</ul></li>
<li><p><strong>Syntax:</strong> <code>outarray = hr2lr(inarray, innature = innature, $</code><br />
<code>DEBUG = debug, EXCPT_COND = excpt_cond)</code></p></li>
<li><p><strong>Positional parameters [Input/Output]:</strong></p>
<ul>
<li><p><code>inarray {UINT or FLOAT} [I]:</code> An array of <span class="math inline">2048&#8197;&#215;&#8197;512</span> elements, presumably containing data from a <span class="smallcaps">MISR</span> <span class="smallcaps">L1B2</span> high spatial resolution field.</p></li>
<li><p><code>innature {STRING} [I] (Default value: None):</code> Indicator of the nature and expected value range of the input array <code>inarray</code>:</p>
<ul>
<li><p>If <code>innature = &#8217;RDQI&#8217;</code>, usable values of the input array <code>inarray</code> are expected to range between <code>0B</code> and <code>3B</code>; the corresponding values of outarray depends on the <strong>largest value</strong> found in each subwindow.</p></li>
<li><p>If <code>innature = &#8217;Mask&#8217;</code>, usable values of the input array <code>inarray</code> are expected to range between <code>1B</code> and <code>3B</code>; the corresponding values of outarray depends on the <strong>most frequent value</strong> found in each subwindow.</p></li>
<li><p>If <code>innature = &#8217;Radrd&#8217;</code>, usable values of the input array <code>inarray</code> are expected to range between <code>0U</code> and <code>65506U</code>; the corresponding values of outarray depends on the <strong>average usable value</strong> (after removing the <span class="smallcaps">RDQI</span>) found in each subwindow, with the maximum <span class="smallcaps">RDQI</span> value mong the usable values.</p></li>
<li><p>If <code>innature = &#8217;Rad&#8217;</code>, usable values of the input array <code>inarray</code> are expected to range between <code>0.0</code> and <code>800.0</code>; the corresponding values of outarray depends on the <strong>average usable value</strong> found in each subwindow.</p></li>
<li><p>If <code>innature = &#8217;Brf&#8217;</code>, usable values of the input array <code>inarray</code> are expected to range between <code>0.0</code> and <code>2.0</code>; the corresponding values of outarray depends on the <strong>average usable value</strong> found in each subwindow.</p></li>
</ul></li>
</ul></li>
<li><p><strong>Keyword parameters [Input/Output]:</strong></p>
<ul>
<li><p><code>DEBUG = debug {INT} [I] (Default value: 0):</code> Flag to activate (<code>1</code>) or skip (<code>0</code>) debugging tests.</p></li>
<li><p><code>EXCPT_COND = excpt_cond {STRING} [O] (Default value: &#8221;):</code> Description of the exception condition if one has been encountered, or a null string otherwise.</p></li>
</ul></li>
<li><p><strong>Returned value type:</strong> A numeric array, dimensioned <span class="math inline">512&#8197;&#215;&#8197;128</span>, if the processing was successful, or an <code>INT</code> (error code) otherwise.</p></li>
<li><p><strong>Outcome:</strong></p>
<ul>
<li><p>If no exception condition has been detected, this function returns a numeric array of the same type as <code>inarray</code> and dimensioned <span class="math inline">512&#8197;&#215;&#8197;128</span> elements, where the value of each element is defined as described above. The output keyword parameter <code>excpt_cond</code> is set to a null string, if the optional input keyword parameter <code>DEBUG</code> was set and if the optional output keyword parameter <code>EXCPT_COND</code> was provided in the call.</p></li>
<li><p>If an exception condition has been detected, this function returns a non-zero error code, and the output keyword parameter <code>excpt_cond</code> contains a message about the exception condition encountered, if the optional input keyword parameter <code>DEBUG</code> is set and if the optional output keyword parameter <code>EXCPT_COND</code> is provided.</p></li>
</ul></li>
<li><p><strong>Exception conditions:</strong></p>
<ul>
<li><p>Error 100: One or more positional parameter(s) are missing.</p></li>
<li><p>Error 110: Positional parameter <code>inarray</code> is not an array of type <code>BYTE</code>, <code>UINT</code>, or <code>FLOAT</code>.</p></li>
<li><p>Error 120: Argument <code>innature</code> is not a scalar of type <code>STRING</code>.</p></li>
<li><p>Error 130: Argument <code>innature</code> is not recognized: must be <code>RDQI</code>, <code>Mask</code>, <code>Rad</code>, <code>Brf</code> or <code>Radrd</code>.</p></li>
<li><p>Error 140: Arguments <code>inarray</code> and <code>innature</code> are incompatible.</p></li>
<li><p>Error 200: Positional parameter <code>inarray</code> is not properly dimensioned: must be <span class="math inline">2048&#8197;&#215;&#8197;512</span>.</p></li>
</ul></li>
<li><p><strong>Dependencies:</strong></p>
<ul>
<li><p><code>is_array.pro</code></p></li>
<li><p><code>is_byte.pro</code></p></li>
<li><p><code>is_float.pro</code></p></li>
<li><p><code>is_scalar.pro</code></p></li>
<li><p><code>is_string.pro</code></p></li>
<li><p><code>is_uint.pro</code></p></li>
<li><p><code>strstr.pro</code></p></li>
</ul></li>
<li><p><strong>Remarks:</strong></p>
<ul>
<li><p><strong>Note 1:</strong> This function is specifically designed to handle <code>MISR</code> <code>L1B2</code> scaled and unscaled <span class="smallcaps">Radiance</span>, as well as <span class="smallcaps">Brf</span> data arrays, as well as <span class="smallcaps">RDQI</span> and land cover masks.</p></li>
<li><p><strong>Note 2:</strong> Since this function averages up to 16 original values to estimate 1 low resolution value, it reduces the information content of the original file. Contrast this with the function <code>lr2hr.pro</code>, which appears to implement the reverse transformation, but only duplicates values. Hence <code>lr2hr(hr2lr(hr_array))</code> is generally not equivalent to <code>hr_array</code>.</p></li>
</ul></li>
<li><p><strong>Examples:</strong></p>
<pre><code>IDL&gt; inarray = FLTARR(2048, 512)
IDL&gt; outarray = hr2lr(inarray, /DEBUG, EXCPT_COND = excpt_cond)
IDL&gt; HELP, outarray
OUTARRAY        FLOAT     = Array[512, 128]</code></pre></li>
<li><p><strong>References:</strong> None.</p></li>
<li><p><strong>Versioning:</strong></p>
<ul>
<li><p>2012&#8211;11&#8211;22: Version 0.5 &#8212; Initial release by Linda Hunt (as <code>downsize_fullres</code>).</p></li>
<li><p>2017&#8211;07&#8211;17: Version 0.9 &#8212; Changed the function name to <code>hr2lr</code>, removed arguments <code>factor</code> (fixed, in this context) and <code>maxgood</code> (not used), added code to handle cases when <code>WHERE</code> returns <code>-1</code>), added tests and in-line documentation.</p></li>
<li><p>2018&#8211;01&#8211;30: Version 1.0 &#8212; Initial public release.</p></li>
<li><p>2018&#8211;05&#8211;13: Version 1.1 &#8212; In-line documentation update.</p></li>
<li><p>2018&#8211;05&#8211;18: Version 1.5 &#8212; Implement new coding standards.</p></li>
<li><p>2018&#8211;12&#8211;20: Version 1.6 &#8212; Correct a bug in the computation of indices that resulted in incorrect values in the last column and last line of the lower resolution array, add code to adjust processing as a function of the input array data type, and update the documentation.</p></li>
<li><p>2019&#8211;01&#8211;24: Version 1.7 &#8212; Update the code to also handle input arrays of type <code>BYTE</code>.</p></li>
<li><p>2019&#8211;03&#8211;01: Version 2.00 &#8212; Update the code to also handle input arrays of type <code>UINT</code>; systematic update of all routines to implement stricter coding standards and improve documentation.</p></li>
<li><p>2019&#8211;08&#8211;20: Version 2.1.0 &#8212; Adopt revised coding and documentation standards (in particular regarding the use of <code>verbose</code> and the assignment of numeric return codes), and switch to 3-parts version identifiers.</p></li>
<li><p>2019&#8211;08&#8211;20: Version 2.1.1 &#8212; Update the code to handle land, water and cloud <code>BYTE</code> masks differently from <span class="smallcaps">RDQI</span>.</p></li>
<li><p>2019&#8211;09&#8211;27: Version 2.1.2 &#8212; Add the input positional parameter <code>innature</code> and update the code to explicitly process input arrays containing <span class="smallcaps">RDQI</span>, <span class="smallcaps">Mask</span>, <span class="smallcaps">Radrd</span>, <span class="smallcaps">Rad</span> or <span class="smallcaps">Brf</span> data with specific dedicated algorithms. The code segment dedicated to scaled radiances without the <span class="smallcaps">RDQI</span> attached is deleted because it is never used.</p></li>
</ul></li>
</ul>
<h2>is_frompath</h2>
<ul>
<li><p><strong>Purpose:</strong> This function checks that the specified <span class="smallcaps">MISR</span> <span class="smallcaps">Orbit</span> does belong to the specified <span class="smallcaps">Path</span>.</p></li>
<li><p><strong>Algorithm:</strong> This function relies of the <span class="smallcaps">MISR</span> Toolkit to determine the correct <span class="smallcaps">Path</span> associated with the given <span class="smallcaps">Orbit</span>, and returns <code>1</code> if the input positional parameters are consistent, or <code>0</code> otherwise.</p></li>
<li><p><strong>Syntax:</strong> <code>res = is_frompath(misr_path, misr_orbit, $</code><br />
<code>DEBUG = debug, EXCPT_COND = excpt_cond)</code></p></li>
<li><p><strong>Positional parameters [Input/Output]:</strong></p>
<ul>
<li><p><code>misr_path {INTEGER} [I]:</code> The selected <span class="smallcaps">MISR</span> <span class="smallcaps">Path</span> number.</p></li>
<li><p><code>misr_orbit {LONG} [I]:</code> The selected <span class="smallcaps">MISR</span> <span class="smallcaps">Orbit</span> number.</p></li>
</ul></li>
<li><p><strong>Keyword parameters [Input/Output]:</strong></p>
<ul>
<li><p><code>DEBUG = debug {INT} [I] (Default value: 0):</code> Flag to activate (<code>1</code>) or skip (<code>0</code>) debugging tests.</p></li>
<li><p><code>EXCPT_COND = excpt_cond {STRING} [O] (Default value: &#8221;):</code> Description of the exception condition if one has been encountered, or a null string otherwise.</p></li>
</ul></li>
<li><p><strong>Returned value type:</strong> <code>INT</code>.</p></li>
<li><p><strong>Outcome:</strong></p>
<ul>
<li><p>If no exception condition has been detected, this function returns <code>1</code> if the input positional parameter <code>misr_orbit</code> does belong to the specified <code>misr_path</code>, and <code>0</code> otherwise, and the output keyword parameter <code>excpt_cond</code> is set to a null string, if the optional input keyword parameter <code>DEBUG</code> is set and if the optional output keyword parameter <code>EXCPT_COND</code> is provided in the call.</p></li>
<li><p>If an exception condition has been detected, this function returns <code>-1</code>, and the output keyword parameter <code>excpt_cond</code> contains a message about the exception condition encountered, if the optional input keyword parameter <code>DEBUG</code> is set and if the optional output keyword parameter <code>EXCPT_COND</code> is provided.</p></li>
</ul></li>
<li><p><strong>Exception conditions:</strong></p>
<ul>
<li><p>Error 100: One or more positional parameter(s) are missing.</p></li>
<li><p>Error 110: The input positional parameter <code>misr_path</code> is invalid.</p></li>
<li><p>Error 120: The input positional parameter <code>misr_orbit</code> is invalid.</p></li>
<li><p>Error 600: An exception condition occurred in the <span class="smallcaps">MISR</span> <span class="smallcaps">Toolkit</span> routine<br />
<code>MTK_ORBIT_TO_PATH</code>.</p></li>
</ul></li>
<li><p><strong>Dependencies:</strong></p>
<ul>
<li><p><code>MISR Toolkit</code></p></li>
<li><p><code>chk_misr_orbit.pro</code></p></li>
<li><p><code>chk_misr_path.pro</code></p></li>
<li><p><code>strstr.pro</code></p></li>
</ul></li>
<li><p><strong>Remarks:</strong> None.</p></li>
<li><p><strong>Examples:</strong></p>
<pre><code>IDL&gt; misr_path = 168
IDL&gt; misr_orbit = 68050L
IDL&gt; debug = 1
IDL&gt; res = is_frompath(misr_path, misr_orbit, $
   DEBUG = debug, EXCPT_COND = excpt_cond)
IDL&gt; PRINT, &#39;res = &#39;, res
res =            1
IDL&gt; misr_orbit = 68051L
IDL&gt; res = is_frompath(misr_path, misr_orbit, $
   DEBUG = debug, EXCPT_COND = excpt_cond)
IDL&gt; PRINT, &#39;res = &#39;, res
res =            0</code></pre></li>
<li><p><strong>References:</strong> None.</p></li>
<li><p><strong>Versioning:</strong></p>
<ul>
<li><p>2019&#8211;03&#8211;17: Version 1.0 &#8212; Initial release.</p></li>
<li><p>2019&#8211;03&#8211;20: Version 2.00 &#8212; Systematic update of all routines to implement stricter coding standards and improve documentation.</p></li>
<li><p>2019&#8211;05&#8211;04: Version 2.01 &#8212; Update the code to report the specific error message of MTK routines.</p></li>
<li><p>2019&#8211;06&#8211;11: Version 2.02 &#8212; Update the code to return an error code <code>-1</code> if an exception condition is encountered in the <span class="smallcaps">MISR</span> <span class="smallcaps">Toolkit</span> function <code>MTK_ORBIT_TO_PATH</code>.</p></li>
<li><p>2019&#8211;08&#8211;20: Version 2.1.0 &#8212; Adopt revised coding and documentation standards (in particular regarding the assignment of numeric return codes), and switch to 3-parts version identifiers.</p></li>
</ul></li>
</ul>
<h2>latlonp2bls</h2>
<ul>
<li><p><strong>Purpose:</strong> This function identifies the <span class="smallcaps">Block</span>, <span class="smallcaps">Line</span> and <span class="smallcaps">Sample</span> coordinates of the <span class="smallcaps">MISR</span> pixel closest to the specified latitude and longitude, and updates the latitude and longitude to reflect the geographical coordinates of the center of that closest pixel.</p></li>
<li><p><strong>Algorithm:</strong> This function converts the geographical coordinates (latitude and longitude, in decimal degrees) of a specified location, within a given <span class="smallcaps">MISR</span> <span class="smallcaps">Path</span> into the <span class="smallcaps">Block</span>, <span class="smallcaps">Line</span> and <span class="smallcaps">Sample</span> coordinates of the center of the closest pixel within that <span class="smallcaps">Path</span>, and then computes and returns the latitude and longitude, in decimal degrees, of that center pixel.</p></li>
<li><p><strong>Syntax:</strong> <code>rc = latlonp2bls(misr_path, misr_resol, latitude, longitude, $</code><br />
<code>misr_block, misr_line, misr_sample, $</code><br />
<code>DEBUG = debug, EXCPT_COND = excpt_cond)</code></p></li>
<li><p><strong>Positional parameters [Input/Output]:</strong></p>
<ul>
<li><p><code>misr_path {INT} [I]:</code> The selected <span class="smallcaps">MISR</span> <span class="smallcaps">Path</span> number.</p></li>
<li><p><code>misr_resol {INT} [I]:</code> The selected <span class="smallcaps">MISR</span> spatial resolution (either 275 or 1100 m).</p></li>
<li><p><code>latitude {DOUBLE} [I/O]:</code> The latitude of a location of interest on input, the latitude of the center of the nearest pixel on output.</p></li>
<li><p><code>longitude {DOUBLE} [I/O]:</code> The longitude of a location of interest on input, the longitude of the center of the nearest pixel on output.</p></li>
<li><p><code>misr_block {INT} [O]:</code> The <span class="smallcaps">MISR</span> <span class="smallcaps">Block</span> number containing that location.</p></li>
<li><p><code>misr_line {INT} [O]:</code> The line number of the closest pixel to the specified location with the indicated <span class="smallcaps">Block</span>.</p></li>
<li><p><code>misr_sample {INT} [O]:</code> The sample number of the closest pixel to the specified location with the indicated <span class="smallcaps">Block</span>.</p></li>
</ul></li>
<li><p><strong>Keyword parameters [Input/Output]:</strong></p>
<ul>
<li><p><code>DEBUG = debug {INT} [I] (Default value: 0):</code> Flag to activate (<code>1</code>) or skip (<code>0</code>) debugging tests.</p></li>
<li><p><code>EXCPT_COND = excpt_cond {STRING} [O] (Default value: &#8221;):</code> Description of the exception condition if one has been encountered, or a null string otherwise.</p></li>
</ul></li>
<li><p><strong>Returned value type:</strong> <code>INT</code>.</p></li>
<li><p><strong>Outcome:</strong></p>
<ul>
<li><p>If no exception condition has been detected, this function returns <code>0</code>, and the output keyword parameter <code>excpt_cond</code> is set to a null string, if the optional input keyword parameter <code>DEBUG</code> is set and if the optional output keyword parameter <code>EXCPT_COND</code> is provided in the call. The output positional parameters <code>latitude</code>, <code>longitude</code>, <code>misr_block</code>, <code>misr_line</code>, <code>misr_sample</code> contain the results generated by this function.</p></li>
<li><p>If an exception condition has been detected, this function returns a non-zero error code, and the output keyword parameter <code>excpt_cond</code> contains a message about the exception condition encountered, if the optional input keyword parameter <code>DEBUG</code> is set and if the optional output keyword parameter <code>EXCPT_COND</code> is provided. The output positional parameters may be undefined, incomplete or incorrect.</p></li>
</ul></li>
<li><p><strong>Exception conditions:</strong></p>
<ul>
<li><p>Error 100: One or more positional parameter(s) are missing.</p></li>
<li><p>Error 110: The input positional parameter <code>misr_path</code> is invalid.</p></li>
<li><p>Error 120: The input positional parameter <code>misr_resol</code> is invalid.</p></li>
<li><p>Error 130: The input positional parameter <code>latitude</code> is not a scalar number or lies outside of the range <span class="math inline">[&#8197;&#8722;&#8197;90.0,&#8198;&#8197;+&#8197;90.0]</span>.</p></li>
<li><p>Error 140: The input positional parameter <code>longitude</code> is not a scalar number or lies outside of the range <span class="math inline">[&#8197;&#8722;&#8197;180.0,&#8198;&#8197;+&#8197;180.0]</span>.</p></li>
<li><p>Error 600: An exception condition occurred in the <span class="smallcaps">MISR</span> <span class="smallcaps">Toolkit</span> routine<br />
<code>MTK_LATLON_TO_BLS</code>.</p></li>
<li><p>Error 610: An exception condition occurred in the <span class="smallcaps">MISR</span> <span class="smallcaps">Toolkit</span> routine<br />
<code>MTK_BLS_TO_LATLON</code>.</p></li>
</ul></li>
<li><p><strong>Dependencies:</strong></p>
<ul>
<li><p><code>MISR Toolkit</code></p></li>
<li><p><code>chk_misr_path.pro</code></p></li>
<li><p><code>chk_misr_resol.pro</code></p></li>
<li><p><code>is_numeric.pro</code></p></li>
<li><p><code>is_scalar.pro</code></p></li>
<li><p><code>strstr.pro</code></p></li>
</ul></li>
<li><p><strong>Remarks:</strong></p>
<ul>
<li><p><strong>Note 1:</strong> The positional parameters <code>latitude</code> and <code>longitude</code> are modified on output to reflect the geographical coordinates of the center of the pixel closest to the location specified in input.</p></li>
<li><p><strong>Note 2:</strong> The finest spatial sampling distance of the <span class="smallcaps">MISR</span> instrument is 275 m. Along a meridian, this corresponds to just under 9 arc seconds or 0.0024 arc degree, so geographical coordinates should be specified with at least 5 significant digits to uniquely designate a particular pixel. See the examples below.</p></li>
</ul></li>
<li><p><strong>Examples:</strong></p>
<pre><code>IDL&gt; misr_path = 169
IDL&gt; misr_resol = 275
IDL&gt; latitude = -27.360
IDL&gt; longitude = 30.130
IDL&gt; rc = latlonp2bls(misr_path, misr_resol, $
   latitude, longitude, misr_block, misr_line, misr_sample)
IDL&gt; PRINT, misr_block, misr_line, misr_sample
         112         399        1135
IDL&gt; latitude = -27.361
IDL&gt; rc = latlonp2bls(misr_path, misr_resol, $
   latitude, longitude, misr_block, misr_line, misr_sample)
IDL&gt; PRINT, misr_block, misr_line, misr_sample
         112         399        1135
IDL&gt; latitude = -27.362
IDL&gt; rc = latlonp2bls(misr_path, misr_resol, $
   latitude, longitude, misr_block, misr_line, misr_sample)
IDL&gt; PRINT, misr_block, misr_line, misr_sample
         112         400        1135</code></pre></li>
<li><p><strong>References:</strong> None.</p></li>
<li><p><strong>Versioning:</strong></p>
<ul>
<li><p>2019&#8211;06&#8211;09: Version 1.0 &#8212; Initial public release.</p></li>
<li><p>2019&#8211;06&#8211;10: Version 2.00 &#8212; Systematic update of all routines to implement stricter coding standards and improve documentation.</p></li>
<li><p>2019&#8211;08&#8211;20: Version 2.1.0 &#8212; Adopt revised coding and documentation standards (in particular regarding the assignment of numeric return codes), and switch to 3-parts version identifiers.</p></li>
</ul></li>
</ul>
<h2>lr2hr</h2>
<ul>
<li><p><strong>Purpose:</strong> This function upsizes the low spatial resolution (<span class="math inline">512&#8197;&#215;&#8197;128</span>) input array <code>inarray</code> by a factor 4 in each dimension, to a high spatial resolution (<span class="math inline">2048&#8197;&#215;&#8197;512</span>) output array of the same type, and returns the latter to the calling routine.</p></li>
<li><p><strong>Algorithm:</strong> This function duplicates 16 times the value of each pixel in the low-resolution data set to generate a pseudo high-resolution output array <code>outarray</code> of the same type as <code>inarray</code>.</p></li>
<li><p><strong>Syntax:</strong> <code>outarray = lr2hr(inarray, DEBUG = debug, EXCPT_COND = excpt_cond)</code></p></li>
<li><p><strong>Positional parameters [Input/Output]:</strong></p>
<ul>
<li><p><code>inarray {Numeric} [I]:</code> An array of <span class="math inline">512&#8197;&#215;&#8197;128</span> elements, presumably retrieved from one of the low spatial resolution grids of an <span class="smallcaps">L1B2</span> GRP ToA GM radiance file.</p></li>
</ul></li>
<li><p><strong>Keyword parameters [Input/Output]:</strong></p>
<ul>
<li><p><code>DEBUG = debug {INT} [I] (Default value: 0):</code> Flag to activate (<code>1</code>) or skip (<code>0</code>) debugging tests.</p></li>
<li><p><code>EXCPT_COND = excpt_cond {STRING} [O] (Default value: &#8221;):</code> Description of the exception condition if one has been encountered, or a null string otherwise.</p></li>
</ul></li>
<li><p><strong>Returned value type:</strong> A numeric array, dimensioned <span class="math inline">2048&#8197;&#215;&#8197;512</span>, of the same type as <code>inarray</code>, if no exception condition has been detected, or an <code>INT</code> otherwise.</p></li>
<li><p><strong>Outcome:</strong></p>
<ul>
<li><p>If no exception condition has been detected, this function returns a numeric array of the same type as <code>inarray</code> and dimensioned <span class="math inline">2048&#8197;&#215;&#8197;512</span> elements, where each element of <code>inarray</code> is duplicated 16 (<span class="math inline">4&#8197;&#215;&#8197;4</span>) times in <code>outarray</code>. The output keyword parameter <code>excpt_cond</code> is set to a null string, if the optional input keyword parameter <code>DEBUG</code> was set and if the optional output keyword parameter <code>EXCPT_COND</code> was provided in the call.</p></li>
<li><p>If an exception condition has been detected, this function returns an <code>INTEGER</code> array dimensioned <span class="math inline">2048&#8197;&#215;&#8197;512</span> elements, where each element is set to <code>-1</code>, and the output keyword parameter <code>excpt_cond</code> contains a message about the exception condition encountered, if the optional input keyword parameter <code>DEBUG</code> is set and if the optional output keyword parameter <code>EXCPT_COND</code> is provided.</p></li>
</ul></li>
<li><p><strong>Exception conditions:</strong></p>
<ul>
<li><p>Error 100: One or more positional parameter(s) are missing.</p></li>
<li><p>Error 110: Positional parameter <code>inarray</code> is not of a numeric type.</p></li>
<li><p>Error 120: Positional parameter <code>inarray</code> is not properly dimensioned: must be [512 x 128].</p></li>
</ul></li>
<li><p><strong>Dependencies:</strong></p>
<ul>
<li><p><code>is_numeric.pro</code></p></li>
<li><p><code>strstr.pro</code></p></li>
</ul></li>
<li><p><strong>Remarks:</strong></p>
<ul>
<li><p><strong>Note 1:</strong> This function is specifically designed to handle <code>MISR</code> <code>L1B2</code> files, but is otherwise generic and could be used in other contexts.</p></li>
<li><p><strong>Note 2:</strong> Since this function duplicates 1 original value to estimate 16 high resolution values, it does not change the information content of the original file. Contrast this with the function <code>hr2lr.pro</code>, which appears to implement the reverse transformation, but implements loses some information in the process. Hence,<br />
<code>hr2lr(lr2hr(lr_array))</code> is not equivalent to <code>lr_array</code>.</p></li>
<li><p><strong>Note 3:</strong> The <span class="smallcaps">MISR-HR</span> processing system does <strong>NOT</strong> rely on this function to generate the <span class="smallcaps">L1B3</span> product. Instead, this function is used exclusively to facilitate comparisons with high spatial resolution data fileds, or to generate maps of Global Mode <span class="smallcaps">MISR</span> data of the same size and visual appearance as those created from Local Mode data or <span class="smallcaps">MISR-HR</span> products.</p></li>
</ul></li>
<li><p><strong>Examples:</strong></p>
<pre><code>IDL&gt; inarray = FLTARR(512, 128)
IDL&gt; outarray = lr2hr(inarray, /DEBUG, EXCPT_COND = excpt_cond)
IDL&gt; HELP, outarray
OUTARRAY        FLOAT     = Array[2048, 512]</code></pre></li>
<li><p><strong>References:</strong> None.</p></li>
<li><p><strong>Versioning:</strong></p>
<ul>
<li><p>2012&#8211;11&#8211;22: Version 0.5 &#8212; Initial release by Linda Hunt (as <code>upsize_array</code>).</p></li>
<li><p>2017&#8211;07&#8211;17: Version 0.9 &#8212; Changed the function name to <code>lr2hr</code>, removed arguments <code>factor</code> (fixed, in this context) and <code>maxgood</code> (not used), added tests and in-line documentation.</p></li>
<li><p>2018&#8211;01&#8211;30: Version 1.0 &#8212; Initial public release.</p></li>
<li><p>2018&#8211;05&#8211;13: Version 1.1 &#8212; In-line documentation update.</p></li>
<li><p>2018&#8211;05&#8211;18: Version 1.5 &#8212; Implement new coding standards.</p></li>
<li><p>2019&#8211;03&#8211;01: Version 2.00 &#8212; Systematic update of all routines to implement stricter coding standards and improve documentation.</p></li>
<li><p>2019&#8211;08&#8211;20: Version 2.1.0 &#8212; Adopt revised coding and documentation standards (in particular regarding the use of <code>verbose</code> and the assignment of numeric return codes), and switch to 3-parts version identifiers.</p></li>
</ul></li>
</ul>
<h2>nearest_pixel</h2>
<ul>
<li><p><strong>Purpose:</strong> This function computes the latitude and longitude of the center of the <span class="smallcaps">MISR</span> or <span class="smallcaps">MISR-HR</span> pixel closest to the latitude and longitude of a site of interest, within the specified <code>misr_path</code>.</p></li>
<li><p><strong>Algorithm:</strong> This function (1) relies on the <span class="smallcaps">MISR</span> <span class="smallcaps">Toolkit</span> functions to convert the latitude and longitude of a site of interest, provided as the input positional parameters <code>lat_sit</code> and <code>lon_sit</code> (in decimal degrees) into fractional line and sample coordinates of a <span class="smallcaps">MISR</span> pixel (resolution of 1100) or of a <span class="smallcaps">MISR-HR</span> pixel (resolution of 275), (2) rounds these off, and (3) relies again on the <span class="smallcaps">MISR</span> <span class="smallcaps">Toolkit</span> functions to compute the latitude and longitude of the center of that pixel. It also reports the distance (on a horizontal plane) between the site of interest and the center of this closest pixel, using the haversine formula and a mean Earth radius of 6,371 km.</p></li>
<li><p><strong>Syntax:</strong> <code>rc = nearest_pixel(misr_path, lat_sit, lon_sit, $</code><br />
<code>resolution, misr_block, misr_line, misr_sample, $</code><br />
<code>lat_pix, lon_pix, distance, $</code><br />
<code>DEBUG = debug, EXCPT_COND = excpt_cond)</code></p></li>
<li><p><strong>Positional parameters [Input/Output]:</strong></p>
<ul>
<li><p><code>misr_path {INTEGER} [I]:</code> The selected <span class="smallcaps">MISR</span> <span class="smallcaps">Path</span> number.</p></li>
<li><p><code>lat_sit {DOUBLE} [I]:</code> The latitude of the site of interest, in decimal degrees.</p></li>
<li><p><code>lon_sit {DOUBLE} [I]:</code> The longitude of the site of interest, in decimal degrees.</p></li>
<li><p><code>resolution {INT} [I]:</code> The spatial resolution of the remote sensing data product: either 1100 (for the Global Mode non-red spectral channels of the off-nadir <span class="smallcaps">MISR</span> cameras) or 275 (for the Global Mode red spectral channels of the off-nadir <span class="smallcaps">MISR</span> cameras, or the 4 spectral bands of the nadir camera, or for any data channel in Local Mode, or for any <span class="smallcaps">MISR-HR</span> data product).</p></li>
<li><p><code>misr_block {INTEGER} [O]:</code> The <span class="smallcaps">MISR</span> <span class="smallcaps">Block</span> number in which the site of interest resides.</p></li>
<li><p><code>misr_line {INTEGER} [O]:</code> The line number of the pixel in the <span class="smallcaps">Block</span>.</p></li>
<li><p><code>misr_sample {INTEGER} [O]:</code> The sample number of the pixel in the <code>line</code>.</p></li>
<li><p><code>lat_pix {DOUBLE} [O]:</code> The latitude of the center of the pixel closest to the site of interest, in decimal degrees, within the range <code>[-90.0, 90.0]</code>.</p></li>
<li><p><code>lon_pix {DOUBLE} [O]:</code> The longitude of the center of the pixel closest to the site of interest, in decimal degrees, within the range <code>[-180.0, 180.0]</code>.</p></li>
<li><p><code>distance {DOUBLE} [O]:</code> The distance between the site of interest and the center of the closest pixel.</p></li>
</ul></li>
<li><p><strong>Keyword parameters [Input/Output]:</strong></p>
<ul>
<li><p><code>DEBUG = debug {INT} [I] (Default value: 0):</code> Flag to activate (<code>1</code>) or skip (<code>0</code>) debugging tests.</p></li>
<li><p><code>EXCPT_COND = excpt_cond {STRING} [O] (Default value: &#8221;):</code> Description of the exception condition if one has been encountered, or a null string otherwise.</p></li>
</ul></li>
<li><p><strong>Returned value type:</strong> <code>INT</code>.</p></li>
<li><p><strong>Outcome:</strong></p>
<ul>
<li><p>If no exception condition has been detected, this function returns <code>0</code>, and the output keyword parameter <code>excpt_cond</code> is set to a null string, if the optional input keyword parameter <code>DEBUG</code> is set and if the optional output keyword parameter <code>EXCPT_COND</code> is provided in the call. The coordinates of the center of the closest pixel, as well as the distance between that location and the site of interest are provided in output positional parameters.</p></li>
<li><p>If an exception condition has been detected, this function returns a non-zero error code, and the output keyword parameter <code>excpt_cond</code> contains a message about the exception condition encountered, if the optional input keyword parameter <code>DEBUG</code> is set and if the optional output keyword parameter <code>EXCPT_COND</code> is provided. The coordinates of the center of the closest pixel, as well as the distance between that location and the site of interest may be undefined, incomplete or incorrect.</p></li>
</ul></li>
<li><p><strong>Exception conditions:</strong></p>
<ul>
<li><p>Error 100: One or more positional parameter(s) are missing.</p></li>
<li><p>Error 110: The input positional parameter <code>misr_path</code> is invalid.</p></li>
<li><p>Error 120: The input positional parameter <code>lat_sit</code> is is not of type <code>FLOAT</code> or <code>DOUBLE</code>.</p></li>
<li><p>Error 122: The input positional parameter <code>lat_sit</code> is invalid.</p></li>
<li><p>Error 130: The input positional parameter <code>lon_sit</code> is is not of type <code>FLOAT</code> or <code>DOUBLE</code>.</p></li>
<li><p>Error 132: The input positional parameter <code>lon_sit</code> is invalid.</p></li>
<li><p>Error 140: The input positional parameter <code>resolution</code> is is not of type <code>INT</code>.</p></li>
<li><p>Error 142: The input positional parameter <code>resolution</code> is is invalid.</p></li>
<li><p>Error 200: An exception condition occurred in function <code>haversine.pro</code>.</p></li>
<li><p>Error 600: An exception condition occurred in the <span class="smallcaps">MISR</span> <span class="smallcaps">Toolkit</span> routine<br />
<code>MTK_LATLON_TO_BLS</code>.</p></li>
<li><p>Error 610: An exception condition occurred in the <span class="smallcaps">MISR</span> <span class="smallcaps">Toolkit</span> routine<br />
<code>MTK_BLS_TO_LATLON</code>.</p></li>
</ul></li>
<li><p><strong>Dependencies:</strong></p>
<ul>
<li><p><code>MISR Toolkit</code></p></li>
<li><p><code>chk_misr_path.pro</code></p></li>
<li><p><code>haversine.pro</code></p></li>
<li><p><code>is_double.pro</code></p></li>
<li><p><code>is_float.pro</code></p></li>
<li><p><code>is_integer.pro</code></p></li>
<li><p><code>is_numeric.pro</code></p></li>
<li><p><code>strstr.pro</code></p></li>
</ul></li>
<li><p><strong>Remarks:</strong> None.</p></li>
<li><p><strong>Examples:</strong></p>
<pre><code>IDL&gt; misr_path = 168
IDL&gt; lat_sit = -27.34439555
IDL&gt; lon_sit = 30.13553714
IDL&gt; lat_sit = -27.34439555D
IDL&gt; lon_sit = 30.13553714D
IDL&gt; resolution = 275
IDL&gt; rc = nearest_pixel(misr_path, lat_sit, lon_sit, resolution, $
   misr_block, lat_pix, lon_pix, distance)
IDL&gt; PRINT, &#39;distance = &#39; + strstr(distance)
distance = 132.22869</code></pre></li>
<li><p><strong>References:</strong> None.</p></li>
<li><p><strong>Versioning:</strong></p>
<ul>
<li><p>2019&#8211;04&#8211;06: Version 1.0 &#8212; Initial release.</p></li>
<li><p>2019&#8211;04&#8211;06: Version 2.00 &#8212; Systematic update of all routines to implement stricter coding standards and improve documentation.</p></li>
<li><p>2019&#8211;04&#8211;12: Version 2.01 &#8212; Add the <code>misr_line</code> and <code>misr_sample</code> output positional parameters.</p></li>
<li><p>2019&#8211;05&#8211;04: Version 2.02 &#8212; Update the code to report the specific error message of MTK routines.</p></li>
<li><p>2019&#8211;08&#8211;20: Version 2.1.0 &#8212; Adopt revised coding and documentation standards (in particular regarding the assignment of numeric return codes), and switch to 3-parts version identifiers.</p></li>
</ul></li>
</ul>
<h2>orbit2date</h2>
<ul>
<li><p><strong>Purpose:</strong> This function returns the date of acquisition of the specified <span class="smallcaps">MISR</span> <span class="smallcaps">Orbit</span>, either as a <code>STRING</code> or as a <code>LONG</code> Julian day number.</p></li>
<li><p><strong>Algorithm:</strong> This function relies on <span class="smallcaps">MISR</span> <span class="smallcaps">Toolkit</span> routine <code>MTK_ORBIT_TO_TIMERANGE</code> to determine the date on which the specified <span class="smallcaps">MISR</span> <span class="smallcaps">Orbit</span> was acquired.</p></li>
<li><p><strong>Syntax:</strong> <code>res = orbit2date(misr_orbit, DATAPOOL = datapool, $</code><br />
<code>JULIAN = julian, DEBUG = debug, EXCPT_COND = excpt_cond)</code></p></li>
<li><p><strong>Positional parameters [Input/Output]:</strong></p>
<ul>
<li><p><code>misr_orbit {LONG} [I]:</code> The selected <span class="smallcaps">MISR</span> <span class="smallcaps">Orbit</span> number.</p></li>
</ul></li>
<li><p><strong>Keyword parameters [Input/Output]:</strong></p>
<ul>
<li><p><code>DATAPOOL = datapool {STRING} [I] (Default value: 0):</code> Flag to request (<code>1</code>) or decline (<code>0</code>) returning the output as a <code>STRING</code> formatted as <code>yyy.mm.dd</code> instead of the default <code>STRING</code> formatted as <code>yyyy-mm-dd</code>.</p></li>
<li><p><code>JULIAN = julian {INT} [I] (Default value: 0):</code> Flag to request (<code>1</code>) or decline (<code>0</code>) returning the output as a <code>LONG</code> number representing the Julian day number instead of the default <code>STRING</code> formatted as <code>yyyy-mm-dd</code>.</p></li>
<li><p><code>DEBUG = debug {INT} [I] (Default value: 0):</code> Flag to activate (<code>1</code>) or skip (<code>0</code>) debugging tests.</p></li>
<li><p><code>EXCPT_COND = excpt_cond {STRING} [O] (Default value: &#8221;):</code> Description of the exception condition if one has been encountered, or a null string otherwise.</p></li>
</ul></li>
<li><p><strong>Returned value type:</strong> <code>STRING</code> <strong>OR</strong> <code>LONG</code>.</p></li>
<li><p><strong>Outcome:</strong></p>
<ul>
<li><p>If no exception condition has been detected and the optional keyword parameter <code>JULIAN</code> is not invoked, this function returns a <code>STRING</code> containing the date when the selected <span class="smallcaps">MISR</span> <span class="smallcaps">Orbit</span> was acquired, formatted as <code>YYYY-MM-DD</code>. If the optional keyword parameter <code>JULIAN</code> is invoked, this function returns the Julian day number corresponding to the date of acquisition of that <span class="smallcaps">Orbit</span> as a <code>LONG</code> integer. In both cases, the output keyword parameter <code>excpt_cond</code> is set to a null string, if the optional input keyword parameter <code>DEBUG</code> was set and if the optional output keyword parameter <code>EXCPT_COND</code> was provided in the call.</p></li>
<li><p>If an exception condition has been detected, this function returns a null <code>STRING</code>, and the output keyword parameter <code>excpt_cond</code> contains a message about the exception condition encountered, if the optional input keyword parameter <code>DEBUG</code> is set and if the optional output keyword parameter <code>EXCPT_COND</code> is provided.</p></li>
</ul></li>
<li><p><strong>Exception conditions:</strong></p>
<ul>
<li><p>Error 100: One or more positional parameter(s) are missing.</p></li>
<li><p>Error 110: Positional parameter <code>misr_orbit</code> is not a scalar.</p></li>
<li><p>Error 120: Positional parameter <code>misr_orbit</code> is invalid.</p></li>
<li><p>Error 600: An exception condition was encountered in <span class="smallcaps">Mtk</span> routine<br />
<code>MTK_ORBIT_TO_TIMERANGE</code>.</p></li>
</ul></li>
<li><p><strong>Dependencies:</strong></p>
<ul>
<li><p><code>MISR Toolkit</code></p></li>
<li><p><code>chk_misr_orbit.pro</code></p></li>
<li><p><code>is_scalar.pro</code></p></li>
<li><p><code>strcat.pro</code></p></li>
<li><p><code>strstr.pro</code></p></li>
</ul></li>
<li><p><strong>Remarks:</strong></p>
<ul>
<li><p><strong>Note 1:</strong> Argument <code>misr_orbit</code> cannot be smaller than <code>995L</code> (the first <span class="smallcaps">Orbit</span> for which <span class="smallcaps">MISR</span> acquired data, on February 24, 2000) or larger than <code>200,000L</code> (to be acquired on July 25, 2037).</p></li>
<li><p><strong>Note 2:</strong> This function is unusual in that the value returned may be a <code>STRING</code> or a <code>LONG</code> integer number, depending on the setting of the optional input keyword parameter <code>JULIAN</code>.</p></li>
<li><p><strong>Note 3:</strong> If the optional input keyword parameters <code>DATAPOOL</code> and <code>JULIAN</code> are both set, the former overrides the latter.</p></li>
</ul></li>
<li><p><strong>Examples:</strong></p>
<pre><code>IDL&gt; res = orbit2date(68050)
IDL&gt; PRINT, res
2012-10-03

IDL&gt; res = orbit2date(68050, /JULIAN)
IDL&gt; PRINT, res
     2456204

IDL&gt; res = orbit2date(200000, /DEBUG, EXCPT_COND = excpt_cond)
IDL&gt; PRINT, &#39;res = &gt;&#39; + res + &#39;&lt;, excpt_cond = &gt;&#39; + excpt_cond + &#39;&lt;&#39;
res = &gt;&lt;, excpt_cond = &gt;Error 120 in ORBIT2DATE:
Error 300 in CHK_MISR_ORBIT:
Invalid misr_orbit number: must be within [995L, 112000L].&lt;</code></pre></li>
<li><p><strong>References:</strong></p>
<ul>
<li><p>Web site: <code>https://www-misr.jpl.nasa.gov/</code>, select <code>Gallery</code> and search for <code>First Light</code>, accessed on 5 Nov 2017.</p></li>
<li><p><span class="smallcaps">MISR</span> <span class="smallcaps">Toolkit</span> documentation.</p></li>
</ul></li>
<li><p><strong>Versioning:</strong></p>
<ul>
<li><p>2009&#8211;11&#8211;11: Version 0.5 &#8212; Initial release by Linda Hunt (as <code>orbit_to_date</code>).</p></li>
<li><p>2017&#8211;07&#8211;05: Version 0.9 &#8212; Changed function name to <code>orbit2date</code>, updated the in-line documentation and added argument checking logic.</p></li>
<li><p>2017&#8211;11&#8211;30: Version 1.0 &#8212; Initial public release.</p></li>
<li><p>2018&#8211;01&#8211;16: Version 1.1 &#8212; Implement optional debugging.</p></li>
<li><p>2018&#8211;06&#8211;01: Version 1.5 &#8212; Implement new coding standards.</p></li>
<li><p>2018&#8211;09&#8211;21: Version 1.6 &#8212; Add the optional input keyword parameter <code>JULIAN</code> to return the date as a <code>REAL</code> Julian day number instead of a <code>STRING</code> formatted as <code>YYYY-MM-DD</code>.</p></li>
<li><p>2018&#8211;12-12: Version 1.7 &#8212; Add the optional input keyword parameter <code>DATAPOOL</code> to return the date as a <code>STRING</code> formatted as <code>YYYY.MM.DD</code> instead of <code>YYYY-MM-DD</code>.</p></li>
<li><p>2019&#8211;01&#8211;28: Version 2.00 &#8212; Systematic update of all routines to implement stricter coding standards and improve documentation.</p></li>
<li><p>2019&#8211;05&#8211;04: Version 2.01 &#8212; Update the code to report the specific error message of MTK routines.</p></li>
<li><p>2019&#8211;08&#8211;20: Version 2.1.0 &#8212; Adopt revised coding and documentation standards (in particular regarding the assignment of numeric return codes), and switch to 3-parts version identifiers.</p></li>
</ul></li>
</ul>
<h2>orbit2str</h2>
<ul>
<li><p><strong>Purpose:</strong> This function converts a valid <span class="smallcaps">MISR</span> <span class="smallcaps">Orbit</span> number into a properly formatted <code>STRING</code>, with or without the <code>O</code> header.</p></li>
<li><p><strong>Algorithm:</strong> This function converts the input positional parameter <code>misr_orbit</code>, provided as an <code>LONG</code> value, into a zero-padded <code>STRING</code> formatted as <code>Oyyyyyy</code> (by default), or as <code>yyyyyy</code> if the optional input keyword parameter <code>NOHEADER</code> is set.</p></li>
<li><p><strong>Syntax:</strong> <code>rc = orbit2str(misr_orbit, misr_orbit_str, $</code><br />
<code>NOHEADER = noheader, DEBUG = debug, EXCPT_COND = excpt_cond)</code></p></li>
<li><p><strong>Positional parameters [Input/Output]:</strong></p>
<ul>
<li><p><code>misr_orbit {LONG} [I]:</code> The selected <span class="smallcaps">MISR</span> <span class="smallcaps">Orbit</span> number.</p></li>
<li><p><code>misr_orbit_str {STRING} [O]:</code> A <code>STRING</code> representation of the <span class="smallcaps">MISR</span> <span class="smallcaps">Orbit</span> with or without the <code>O</code> header, depending on the input keyword parameter <code>NOHEADER</code>.</p></li>
</ul></li>
<li><p><strong>Keyword parameters [Input/Output]:</strong></p>
<ul>
<li><p><code>NOHEADER = noheader{INT} [I] (Default value: 0):</code> Flag to avoid (<code>1</code>) or add (<code>0</code>) the header <code>O</code> to the ouput positional parameter <code>misr_orbit_str</code>.</p></li>
<li><p><code>DEBUG = debug {INT} [I] (Default value: 0):</code> Flag to activate (<code>1</code>) or skip (<code>0</code>) debugging tests.</p></li>
<li><p><code>EXCPT_COND = excpt_cond {STRING} [O] (Default value: &#8221;):</code> Description of the exception condition if one has been encountered, or a null string otherwise.</p></li>
</ul></li>
<li><p><strong>Returned value type:</strong> <code>INT</code>.</p></li>
<li><p><strong>Outcome:</strong></p>
<ul>
<li><p>If no exception condition has been detected, this function returns <code>0</code>, and the output keyword parameter <code>excpt_cond</code> is set to a null string, if the optional input keyword parameter <code>DEBUG</code> was set and if the optional output keyword parameter <code>EXCPT_COND</code> was provided in the call. The output positional parameter <code>misr_orbit_str</code> contains the string version of the <span class="smallcaps">Orbit</span>, with or without the <code>O</code> header.</p></li>
<li><p>If an exception condition has been detected, this function returns a non-zero error code, and the output keyword parameter <code>excpt_cond</code> contains a message about the exception condition encountered, if the optional input keyword parameter <code>DEBUG</code> is set and if the optional output keyword parameter <code>EXCPT_COND</code> is provided. The output positional parameter <code>misr_orbit_str</code> is set to a null <code>STRING</code>.</p></li>
</ul></li>
<li><p><strong>Exception conditions:</strong></p>
<ul>
<li><p>Error 100: One or more positional parameter(s) are missing.</p></li>
<li><p>Error 110: Input positional parameter <code>misr_orbit</code> is invalid.</p></li>
</ul></li>
<li><p><strong>Dependencies:</strong></p>
<ul>
<li><p><code>chk_misr_orbit.pro</code></p></li>
<li><p><code>strstr.pro</code></p></li>
</ul></li>
<li><p><strong>Remarks:</strong></p>
<ul>
<li><p><strong>Note 1:</strong> A <code>STRING</code> value for the input positional argument <code>misr_orbit</code> is tolerated and results in correct output positional argument <code>misr_orbit_str</code> if the input keyword parameter <code>DEBUG</code> is NOT set, but an error message is issued if this keyword is set, because this situation likely corresponds to an unintentional incorrect user call (see the last example below).</p></li>
</ul></li>
<li><p><strong>Examples:</strong></p>
<pre><code>IDL&gt; misr_orbit = 68050
IDL&gt; rc = orbit2str(misr_orbit, misr_orbit_s, misr_orbit_str, $
   DEBUG = debug, EXCPT_COND = excpt_cond)
IDL&gt; PRINT, &#39;rc = &#39;, rc, &#39; and excpt_cond = &gt;&#39; + excpt_cond + &#39;&lt;&#39;
rc =        0 and excpt_cond = &gt;&lt;
IDL&gt; PRINT, &#39;misr_orbit_s = &gt;&#39; + misr_orbit_s + &#39;&lt;&#39;
misr_orbit_s = &gt;068050&lt;
IDL&gt; PRINT, &#39;misr_orbit_str = &gt;&#39; + misr_orbit_str + &#39;&lt;&#39;
misr_orbit_str = &gt;O068050&lt;

IDL&gt; misr_orbit = &#39;65487&#39;
IDL&gt; rc = orbit2str(misr_orbit, misr_orbit_s, misr_orbit_str)
IDL&gt; PRINT, &#39;rc = &#39; + strstr(rc)
rc = 0
IDL&gt; PRINT, &#39;misr_orbit_s = &gt;&#39; + misr_orbit_s + &#39;&lt;&#39;
misr_orbit_s = &gt;065487&lt;
IDL&gt; PRINT, &#39;misr_orbit_str = &gt;&#39; + misr_orbit_str + &#39;&lt;&#39;
misr_orbit_str = &gt;B065487&lt;</code></pre></li>
<li><p><strong>References:</strong> None.</p></li>
<li><p><strong>Versioning:</strong></p>
<ul>
<li><p>2017&#8211;11&#8211;15: Version 0.9 &#8212; Initial release.</p></li>
<li><p>2017&#8211;11&#8211;30: Version 1.0 &#8212; Initial public release.</p></li>
<li><p>2018&#8211;01&#8211;16: Version 1.1 &#8212; Implement optional debugging.</p></li>
<li><p>2018&#8211;06&#8211;01: Version 1.5 &#8212; Implement new coding standards.</p></li>
<li><p>2019&#8211;01&#8211;28: Version 2.00 &#8212; Systematic update of all routines to implement stricter coding standards and improve documentation.</p></li>
<li><p>2019&#8211;08&#8211;20: Version 2.1.0 &#8212; Adopt revised coding and documentation standards (in particular regarding the assignment of numeric return codes), and switch to 3-parts version identifiers.</p></li>
</ul></li>
</ul>
<h2>path2str</h2>
<ul>
<li><p><strong>Purpose:</strong> This function converts a valid <span class="smallcaps">MISR</span> <span class="smallcaps">Path</span> number into a properly formatted <code>STRING</code>, with or without the <code>P</code> header.</p></li>
<li><p><strong>Algorithm:</strong> This function converts the input positional parameter <code>misr_path</code>, provided as an <code>INT</code> value, into a zero-padded <code>STRING</code> formatted as <code>Pxxx</code> (by default), or as <code>xxx</code> if the optional input keyword parameter <code>NOHEADER</code> is set.</p></li>
<li><p><strong>Syntax:</strong> <code>rc = path2str(misr_path, misr_path_str, $</code><br />
<code>NOHEADER = noheader, DEBUG = debug, EXCPT_COND = excpt_cond)</code></p></li>
<li><p><strong>Positional parameters [Input/Output]:</strong></p>
<ul>
<li><p><code>misr_path {INT} [I]:</code> The selected <span class="smallcaps">MISR</span> <span class="smallcaps">Path</span> number.</p></li>
<li><p><code>misr_path_str {STRING} [O]:</code> A <code>STRING</code> representation of the <span class="smallcaps">MISR</span> <span class="smallcaps">Path</span> with or without the <code>P</code> header, depending on the input keyword parameter <code>NOHEADER</code>.</p></li>
</ul></li>
<li><p><strong>Keyword parameters [Input/Output]:</strong></p>
<ul>
<li><p><code>NOHEADER = noheader{INT} [I] (Default value: 0):</code> Flag to avoid (<code>1</code>) or add (<code>0</code>) the header <code>P</code> to the ouput positional parameter <code>misr_path_str</code>.</p></li>
<li><p><code>DEBUG = debug {INT} [I] (Default value: 0):</code> Flag to activate (<code>1</code>) or skip (<code>0</code>) debugging tests.</p></li>
<li><p><code>EXCPT_COND = excpt_cond {STRING} [O] (Default value: &#8221;):</code> Description of the exception condition if one has been encountered, or a null string otherwise.</p></li>
</ul></li>
<li><p><strong>Returned value type:</strong> <code>INT</code>.</p></li>
<li><p><strong>Outcome:</strong></p>
<ul>
<li><p>If no exception condition has been detected, this function returns <code>0</code>, and the output keyword parameter <code>excpt_cond</code> is set to a null string, if the optional input keyword parameter <code>DEBUG</code> was set and if the optional output keyword parameter <code>EXCPT_COND</code> was provided in the call. The output positional parameter <code>misr_path_str</code> contains the string version of the <span class="smallcaps">Path</span>, with or without the <code>P</code> header.</p></li>
<li><p>If an exception condition has been detected, this function returns a non-zero error code, and the output keyword parameter <code>excpt_cond</code> contains a message about the exception condition encountered, if the optional input keyword parameter <code>DEBUG</code> is set and if the optional output keyword parameter <code>EXCPT_COND</code> is provided. The output positional parameter <code>misr_path_str</code> is set to a null <code>STRING</code>.</p></li>
</ul></li>
<li><p><strong>Exception conditions:</strong></p>
<ul>
<li><p>Error 100: One or more positional parameter(s) are missing.</p></li>
<li><p>Error 110: Input positional parameter <code>misr_path</code> is invalid.</p></li>
</ul></li>
<li><p><strong>Dependencies:</strong></p>
<ul>
<li><p><code>chk_misr_path.pro</code></p></li>
<li><p><code>strstr.pro</code></p></li>
</ul></li>
<li><p><strong>Remarks:</strong></p>
<ul>
<li><p><strong>Note 1:</strong> A <code>STRING</code> value for the input positional argument <code>misr_path</code> is tolerated and results in correct output positional argument <code>misr_path_str</code> if the input keyword parameter <code>DEBUG</code> is NOT set, but an error message is issued if this keyword is set, because this situation likely corresponds to an unintentional incorrect user call (see the last example below).</p></li>
</ul></li>
<li><p><strong>Examples:</strong></p>
<pre><code>IDL&gt; misr_path = 4
IDL&gt; rc = path2str(misr_path, misr_path_str, $
   /DEBUG, EXCPT_COND = excpt_cond)
IDL&gt; PRINT, &#39;rc = &#39;, rc, &#39; and excpt_cond = &gt;&#39; + excpt_cond + &#39;&lt;&#39;
rc =        0 and excpt_cond = &gt;&lt;
IDL&gt; PRINT, &#39;misr_path_str = &gt;&#39; + misr_path_str +&#39;&lt;&#39;
misr_path_str = &gt;P004&lt;

IDL&gt; misr_path = &#39;123&#39;
IDL&gt; rc = path2str(misr_path, misr_path_s, misr_path_str)
IDL&gt; PRINT, &#39;rc = &#39; + strstr(rc)
rc = 0
IDL&gt; PRINT, &#39;misr_path_s = &gt;&#39; + misr_path_s + &#39;&lt;&#39;
misr_path_s = &gt;123&lt;
IDL&gt; PRINT, &#39;misr_path_str = &gt;&#39; + misr_path_str + &#39;&lt;&#39;
misr_path_str = &gt;P123&lt;</code></pre></li>
<li><p><strong>References:</strong> None.</p></li>
<li><p><strong>Versioning:</strong></p>
<ul>
<li><p>2017&#8211;11&#8211;15: Version 0.9 &#8212; Initial release.</p></li>
<li><p>2017&#8211;11&#8211;30: Version 1.0 &#8212; Initial public release.</p></li>
<li><p>2018&#8211;01&#8211;16: Version 1.1 &#8212; Implement optional debugging.</p></li>
<li><p>2018&#8211;06&#8211;01: Version 1.5 &#8212; Implement new coding standards.</p></li>
<li><p>2019&#8211;01&#8211;28: Version 2.00 &#8212; Systematic update of all routines to implement stricter coding standards and improve documentation.</p></li>
<li><p>2019&#8211;08&#8211;20: Version 2.1.0 &#8212; Adopt revised coding and documentation standards (in particular regarding the assignment of numeric return codes), and switch to 3-parts version identifiers.</p></li>
</ul></li>
</ul>
<h2>pixel_corners</h2>
<ul>
<li><p><strong>Purpose:</strong> This function computes the geographical coordinates (latitude and longitude) of each of the 4 corners of an individual <span class="smallcaps">MISR</span> or <span class="smallcaps">MISR-HR</span> pixel.</p></li>
<li><p><strong>Algorithm:</strong> This function relies on the <span class="smallcaps">MISR</span> <span class="smallcaps">Toolkit</span> to compute these coordinates.</p></li>
<li><p><strong>Syntax:</strong> <code>rc = pixel_corners(misr_path, misr_resol, $</code><br />
<code>misr_block, misr_line, misr_sample, corners, $</code><br />
<code>DEBUG = debug, EXCPT_COND = excpt_cond)</code></p></li>
<li><p><strong>Positional parameters [Input/Output]:</strong></p>
<ul>
<li><p><code>misr_path {INT} [I]:</code> The selected <span class="smallcaps">MISR</span> <span class="smallcaps">Path</span> number.</p></li>
<li><p><code>misr_resol {INT} [I]:</code> The selected <span class="smallcaps">MISR</span> or <span class="smallcaps">MISR-HR</span> spatial resolution: either 275 or 1100 m.</p></li>
<li><p><code>misr_block {INT} [I]:</code> The selected <span class="smallcaps">MISR</span> <span class="smallcaps">Block</span> number.</p></li>
<li><p><code>misr_line {INT} [I]:</code> The selected <span class="smallcaps">MISR</span> line number within the <span class="smallcaps">Block</span>.</p></li>
<li><p><code>misr_sample {INT} [I]:</code> The selected <span class="smallcaps">MISR</span> sample number within the line.</p></li>
<li><p><code>corners {STRUCTURE} [O]:</code> The structure containing the latitude and longitude coordinates of the 4 corners of the specified pixel.</p></li>
</ul></li>
<li><p><strong>Keyword parameters [Input/Output]:</strong></p>
<ul>
<li><p><code>DEBUG = debug {INT} [I] (Default value: 0):</code> Flag to activate (<code>1</code>) or skip (<code>0</code>) debugging tests.</p></li>
<li><p><code>EXCPT_COND = excpt_cond {STRING} [O] (Default value: &#8221;):</code> Description of the exception condition if one has been encountered, or a null string otherwise.</p></li>
</ul></li>
<li><p><strong>Returned value type:</strong> <code>INT</code>.</p></li>
<li><p><strong>Outcome:</strong></p>
<ul>
<li><p>If no exception condition has been detected, this function returns <code>0</code>, and the output keyword parameter <code>excpt_cond</code> is set to a null string, if the optional input keyword parameter <code>DEBUG</code> is set and if the optional output keyword parameter <code>EXCPT_COND</code> is provided in the call. The output structure <code>corners</code> contains the desured results.</p></li>
<li><p>If an exception condition has been detected, this function returns a non-zero error code, and the output keyword parameter <code>excpt_cond</code> contains a message about the exception condition encountered, if the optional input keyword parameter <code>DEBUG</code> is set and if the optional output keyword parameter <code>EXCPT_COND</code> is provided. The output structure <code>corners</code> may be undefined, incomplete or incorrect.</p></li>
</ul></li>
<li><p><strong>Exception conditions:</strong></p>
<ul>
<li><p>Error 100: One or more positional parameter(s) are missing.</p></li>
<li><p>Error 110: The input positional parameter <code>misr_path</code> is invalid.</p></li>
<li><p>Error 120: The input positional parameter <code>misr_resol</code> must be either 275 or 1100.</p></li>
<li><p>Error 130: The input positional parameter <code>misr_block</code> is invalid.</p></li>
<li><p>Error 150: The input positional parameter <code>misr_sample</code> is invalid.</p></li>
<li><p>Error 600: An exception condition occurred in the <span class="smallcaps">MISR</span> <span class="smallcaps">Toolkit</span> routine<br />
<code>MTK_BLS_TO_LATLON</code> while computing the coordinates of the nort-west corner.</p></li>
<li><p>Error 610: An exception condition occurred in the <span class="smallcaps">MISR</span> <span class="smallcaps">Toolkit</span> routine<br />
<code>MTK_BLS_TO_LATLON</code> while computing the coordinates of the nort-east corner.</p></li>
<li><p>Error 620: An exception condition occurred in the <span class="smallcaps">MISR</span> <span class="smallcaps">Toolkit</span> routine<br />
<code>MTK_BLS_TO_LATLON</code> while computing the coordinates of the south-west corner.</p></li>
<li><p>Error 630: An exception condition occurred in the <span class="smallcaps">MISR</span> <span class="smallcaps">Toolkit</span> routine<br />
<code>MTK_BLS_TO_LATLON</code> while computing the coordinates of the south-east corner.</p></li>
</ul></li>
<li><p><strong>Dependencies:</strong></p>
<ul>
<li><p><code>MISR Toolkit</code></p></li>
<li><p><code>chk_misr_block.pro</code></p></li>
<li><p><code>chk_misr_path.pro</code></p></li>
<li><p><code>chk_misr_resol.pro</code></p></li>
<li><p><code>strstr.pro</code></p></li>
</ul></li>
<li><p><strong>Remarks:</strong> None.</p></li>
<li><p><strong>Examples:</strong></p>
<pre><code>IDL&gt; misr_path = 168
IDL&gt; misr_resol = 1100
IDL&gt; misr_block = 112
IDL&gt; misr_line = 100
IDL&gt; misr_sample = 240
IDL&gt; debug = 1
IDL&gt; rc = pixel_corners(misr_path, misr_resol, misr_block, $
   misr_line, misr_sample, corners, $
   DEBUG = debug, EXCPT_COND = excpt_cond)
IDL&gt; PRINT, &#39;The NW corner is at lat = &#39;, corners.nwc_lat, $
   &#39; and lon = &#39;, corners.nwc_lon
The NW corner is at lat = -27.317877 and lon = 31.189198
IDL&gt; PRINT, &#39;The SE corner is at lat = &#39;, corners.sec_lat, $
   &#39; and lon = &#39;, corners.sec_lon
The SE corner is at lat = -27.328760 and lon = 31.199127</code></pre></li>
<li><p><strong>References:</strong> None.</p></li>
<li><p><strong>Versioning:</strong></p>
<ul>
<li><p>2019&#8211;04&#8211;07: Version 1.0 &#8212; Initial release.</p></li>
<li><p>2019&#8211;04&#8211;08: Version 2.00 &#8212; Systematic update of all routines to implement stricter coding standards and improve documentation.</p></li>
<li><p>2019&#8211;05&#8211;04: Version 2.01 &#8212; Update the code to report the specific error message of MTK routines.</p></li>
<li><p>2019&#8211;08&#8211;20: Version 2.1.0 &#8212; Adopt revised coding and documentation standards (in particular regarding the assignment of numeric return codes), and switch to 3-parts version identifiers.</p></li>
</ul></li>
</ul>
<h2>range_misr_blocks</h2>
<ul>
<li><p><strong>Purpose:</strong> This function reports on the range of <span class="smallcaps">MISR</span> <span class="smallcaps">Blocks</span> containing actual data (instead of fill data) in a <span class="smallcaps">L1B2</span> Global or Local Mode file.</p></li>
<li><p><strong>Algorithm:</strong> This function retrieves the first and last <span class="smallcaps">MISR</span> <span class="smallcaps">Block</span>s containing useful data from the input positional parameter Global or Local Mode file <code>l1b2_fspec</code>, and sets the values of the output positional parameters <code>start_block</code> and <code>end_block</code> accordingly.</p></li>
<li><p><strong>Syntax:</strong> <code>rc = range_misr_blocks(l1b2_fspec, start_block, end_block, $</code><br />
<code>DEBUG = debug, EXCPT_COND = excpt_cond)</code></p></li>
<li><p><strong>Positional parameters [Input/Output]:</strong></p>
<ul>
<li><p><code>l1b2_fspec {STRING} [I]:</code> The specification (path and name) of the <span class="smallcaps">L1B2</span> Global or Local Mode file to inspect.</p></li>
<li><p><code>start_block {INT} [O]:</code> The nothernmost <span class="smallcaps">Block</span> number containing actual data.</p></li>
<li><p><code>end_block {INT} [O]:</code> The southernmost <span class="smallcaps">Block</span> number containing actual data.</p></li>
</ul></li>
<li><p><strong>Keyword parameters [Input/Output]:</strong></p>
<ul>
<li><p><code>DEBUG = debug {INT} [I] (Default value: 0):</code> Flag to activate (<code>1</code>) or skip (<code>0</code>) debugging tests.</p></li>
<li><p><code>EXCPT_COND = excpt_cond {STRING} [O] (Default value: &#8221;):</code> Description of the exception condition if one has been encountered, or a null string otherwise.</p></li>
</ul></li>
<li><p><strong>Returned value type:</strong> <code>INT</code>.</p></li>
<li><p><strong>Outcome:</strong></p>
<ul>
<li><p>If no exception condition has been detected, this function returns <code>0</code>, and the output keyword parameter <code>excpt_cond</code> is set to a null string, if the optional input keyword parameter <code>DEBUG</code> was set and if the optional output keyword parameter <code>EXCPT_COND</code> was provided in the call. The output positional parameters <code>start_block</code> and<br />
<code>end_block</code> contain the values of the starting and ending <span class="smallcaps">Block</span> numbers, respectively.</p></li>
<li><p>If an exception condition has been detected, this function returns a non-zero error code, and the output keyword parameter <code>excpt_cond</code> contains a message about the exception condition encountered, if the optional input keyword parameter <code>DEBUG</code> is set and if the optional output keyword parameter <code>EXCPT_COND</code> is provided. The output positional parameters <code>start_block</code> and <code>end_block</code> are set to <code>0</code>.</p></li>
</ul></li>
<li><p><strong>Exception conditions:</strong></p>
<ul>
<li><p>Error 100: One or more positional parameter(s) are missing.</p></li>
<li><p>Error 110: Input positional parameter <code>l1b2_fspec</code> is not found or not readable.</p></li>
<li><p>Error 600: An exception condition occurred in the <span class="smallcaps">MISR</span> <span class="smallcaps">Toolkit</span> routine<br />
<code>MTK_FILEATTR_GET</code> while recovering <code>start_block</code>.</p></li>
<li><p>Error 610: An exception condition occurred in the <span class="smallcaps">MISR</span> <span class="smallcaps">Toolkit</span> routine<br />
<code>MTK_FILEATTR_GET</code> while recovering <code>end_block</code>.</p></li>
</ul></li>
<li><p><strong>Dependencies:</strong></p>
<ul>
<li><p><code>MISR Toolkit</code></p></li>
<li><p><code>strstr.pro</code></p></li>
</ul></li>
<li><p><strong>Remarks:</strong> None.</p></li>
<li><p><strong>Examples:</strong></p>
<pre><code>IDL&gt; l1b2_fspec = &#39;/Volumes/MISR_Data3/P168/L1_GM/&#39; + $
   &#39;MISR_AM1_GRP_TERRAIN_GM_P168_O068050_CF_F03_0024.hdf&#39;
IDL&gt; rc = range_misr_blocks(l1b2_fspec, start_block, end_block, $
   DEBUG = debug, EXCPT_COND = excpt_cond)
IDL&gt; PRINT, &#39;rc = &#39; + strstr(rc) + &#39;, excpt_cond = &gt;&#39; + excpt_cond + &#39;&lt;&#39;
rc = 0, excpt_cond = &gt;&lt;
IDL&gt; PRINT, &#39;start_block = &#39; + strstr(start_block)
start_block = 19
IDL&gt; PRINT, &#39;end_block = &#39; + strstr(end_block)
end_block = 162</code></pre></li>
<li><p><strong>References:</strong> None.</p></li>
<li><p><strong>Versioning:</strong></p>
<ul>
<li><p>2017&#8211;12&#8211;13: Version 0.9 &#8212; Initial release.</p></li>
<li><p>2017&#8211;12&#8211;20: Version 1.0 &#8212; Initial public release.</p></li>
<li><p>2018&#8211;01&#8211;16: Version 1.1 &#8212; Implement optional debugging.</p></li>
<li><p>2018&#8211;06&#8211;01: Version 1.5 &#8212; Implement new coding standards.</p></li>
<li><p>2019&#8211;01&#8211;28: Version 2.00 &#8212; Systematic update of all routines to implement stricter coding standards and improve documentation.</p></li>
<li><p>2019&#8211;05&#8211;04: Version 2.01 &#8212; Update the code to report the specific error message of MTK routines.</p></li>
<li><p>2019&#8211;05&#8211;17: Version 2.02 &#8212; Code simplification (<code>FILE_TEST</code>).</p></li>
<li><p>2019&#8211;08&#8211;20: Version 2.1.0 &#8212; Adopt revised coding and documentation standards (in particular regarding the assignment of numeric return codes), and switch to 3-parts version identifiers.</p></li>
</ul></li>
</ul>
<h2>set_misr_specs</h2>
<ul>
<li><p><strong>Purpose:</strong> This function returns a structure containing standard metadata on the <span class="smallcaps">MISR</span> instrument, such as the number, names and angles of the 9 cameras; the number, names and positions of the 4 spectral bands; the size of GM data buffers (512 samples by 128 lines, except 2048 samples by 512 lines for all 4 data channels of the nadir pointing camera or the red spectral band on the other 8 off-nadir cameras); and the standard sequence of 36 data channels (from camera DF to camera DA, and from the Blue band to the NIR band within each camera).</p></li>
<li><p><strong>Algorithm:</strong> This function requires no input; it returns a structure containing metadata on the MISR instrument, as described below.</p></li>
<li><p><strong>Syntax:</strong> <code>misr_specs = set_misr_specs()</code></p></li>
<li><p><strong>Positional parameters [Input/Output]:</strong> None.</p></li>
<li><p><strong>Keyword parameters [Input/Output]:</strong> None.</p></li>
<li><p><strong>Returned value type:</strong> <code>STRUCTURE</code>.</p></li>
<li><p><strong>Outcome:</strong> This function accepts no positional or keyword parameters and returns a structure containing the following elements:</p>
<ul>
<li><p><code>Title = &#8217;MISR Instrument Metadata&#8217;</code>.</p></li>
<li><p><code>NModes = 2</code>.</p></li>
<li><p><code>ModeNames = [&#8217;GM&#8217;, &#8217;LM&#8217;]</code>.</p></li>
<li><p><code>NCameras = 9</code>.</p></li>
<li><p><code>CameraNames = [&#8217;DF&#8217;, &#8217;CF&#8217;, &#8217;BF&#8217;, &#8217;AF&#8217;, &#8217;AN&#8217;, &#8217;AA&#8217;, &#8217;BA&#8217;, &#8217;CA&#8217;, &#8217;DA&#8217;]</code>.</p></li>
<li><p><code>CameraIDs = [1, 2, 3, 4, 5, 6, 7, 8, 9]</code>.</p></li>
<li><p><code>CameraAngles = [70.3, 60.2, 45.7, 26.2, 0.1, 26.2, 45.7, 60.2, 70.6]</code>.</p></li>
<li><p><code>NBands = 4</code>.</p></li>
<li><p><code>BandNames = [&#8217;Blue&#8217;, &#8217;Green&#8217;, &#8217;Red&#8217;, &#8217;NIR&#8217;]</code>.</p></li>
<li><p><code>BandIDs = [0, 1, 2, 3]</code>.</p></li>
<li><p><code>BandPositions = [446.4, 557.5, 671.7, 866.4]</code>.</p></li>
<li><p><code>NChannels = 36</code>.</p></li>
<li><p><code>ChannelOrder = [0, 1, 2, ..., 33, 34, 35]</code>.</p></li>
<li><p><code>ChannelNames = [&#8217;DF_Blue&#8217;, &#8217;DF_Green&#8217;, &#8217;DF_Red&#8217;, ..., &#8217;DA_Green&#8217;, &#8217;DA_Red&#8217;, &#8217;DA_NIR&#8217;]</code>.</p></li>
<li><p><code>GMChannelLines = 128 or 512</code>.</p></li>
<li><p><code>GMChannelSamples = 512 or 2048</code>.</p></li>
<li><p><code>NL1B2Grids = 6</code>.</p></li>
<li><p><code>L1B2GridNames = [&#8217;BlueBand&#8217;, &#8217;GreenBand&#8217;, &#8217;RedBand&#8217;, &#8217;NIRBand&#8217;, &#8217;BRF Conversion Factors&#8217;, &#8217;GeometricParameters&#8217;]</code></p></li>
</ul></li>
<li><p><strong>Exception conditions:</strong> None.</p></li>
<li><p><strong>Dependencies:</strong> None.</p></li>
<li><p><strong>Remarks:</strong></p>
<ul>
<li><p><strong>Note 1:</strong> In the <span class="smallcaps">MISR-HR</span> context, numeric indices referring to Camera, Band and Data Channel arrays are all <code>0</code>-based, although Cameras are sometimes numbered from <code>1</code> to <code>9</code> in the standard <span class="smallcaps">MISR</span> context.</p></li>
</ul></li>
<li><p><strong>Examples:</strong></p>
<pre><code>IDL&gt; misr_specs = set_misr_specs()
IDL&gt; HELP, misr_specs
** Structure &lt;9acc3608&gt;, 18 tags, length=1288, data length=1268, refs=1:
TITLE             STRING    &#39;MISR Instrument Specifications&#39;
NMODES            LONG                 2
MODENAMES         STRING    Array[2]
NCAMERAS          LONG                 9
CAMERANAMES       STRING    Array[9]
CAMERAIDS         LONG      Array[9]
CAMERAANGLES      FLOAT     Array[9]
NBANDS            LONG                 4
BANDNAMES         STRING    Array[4]
BANDIDS           LONG      Array[4]
BANDPOSITIONS     FLOAT     Array[4]
NCHANNELS         LONG                36
CHANNELORDER      INT       Array[36]
CHANNELNAMES      STRING    Array[36]
GMCHANNELLINES    INT       Array[36]
GMCHANNELSAMPLES  INT       Array[36]
NL1B2GRIDS        LONG                 6
L1B2GRIDNAMES     STRING    Array[6]
IDL&gt; PRINT, misr_specs.CAMERANAMES
DF CF BF AF AN AA BA CA DA
IDL&gt; PRINT, misr_specs.BANDPOSITIONS
      446.400      557.500      671.700      866.400</code></pre></li>
<li><p><strong>References:</strong></p>
<ul>
<li><p>Web site: <code>https://www-misr.jpl.nasa.gov/Mission/misrInstrument/</code>, accessed on 6 Nov 2017.</p></li>
<li><p><span class="smallcaps">MISR</span> <span class="smallcaps">Toolkit</span> documentation.</p></li>
</ul></li>
<li><p><strong>Versioning:</strong></p>
<ul>
<li><p>2017&#8211;07&#8211;08: Version 0.8 &#8212; Initial release.</p></li>
<li><p>2017&#8211;09&#8211;03: Version 0.9 &#8212; Add <code>CameraIDs</code> to the output structure.</p></li>
<li><p>2017&#8211;11&#8211;30: Version 1.0 &#8212; Initial public release.</p></li>
<li><p>2018&#8211;05&#8211;01: Version 1.1 &#8212; Add <span class="smallcaps">MISR</span> <span class="smallcaps">Mode</span> information.</p></li>
<li><p>2018&#8211;05&#8211;29: Version 1.2 &#8212; Add <span class="smallcaps">MISR</span> <span class="smallcaps">BandIDs</span> information.</p></li>
<li><p>2018&#8211;06&#8211;01: Version 1.5 &#8212; Implement new coding standards.</p></li>
<li><p>2019&#8211;01&#8211;28: Version 2.00 &#8212; Systematic update of all routines to implement stricter coding standards and improve documentation.</p></li>
<li><p>2019&#8211;02&#8211;24: Version 2.01 &#8212; Add the <code>ChannelOrder</code> array to the output structure <code>misr_specs</code>, and update the documentation.</p></li>
<li><p>2019&#8211;02&#8211;25: Version 2.02 &#8212; Reset the <span class="smallcaps">MISR</span> camera indices to range from 0 to 8 instead of 1 to 9.</p></li>
<li><p>2019&#8211;08&#8211;20: Version 2.1.0 &#8212; Adopt revised coding and documentation standards (in particular regarding the assignment of numeric return codes), and switch to 3-parts version identifiers.</p></li>
<li><p>2019&#8211;09&#8211;15: Version 2.1.1 &#8212; Change the definition of the output structure element <code>ChannelOrder</code> from a 1-D array of 36 elements to a 2-D array dimensioned [9, 4]; add the <code>GMChannelLines</code> and <code>GMChannelSamples</code> items to the output structure. gmchannelsamples</p></li>
</ul></li>
</ul>
<h2>set_roots_vers</h2>
<ul>
<li><p><strong>Purpose:</strong> This function sets</p>
<ul>
<li><p>the <code>STRING</code> array <code>root_dirs</code> to contain the default root directories of the 4 main sets of files used by the <span class="smallcaps">MISR-HR</span> processing system on the current computer, namely</p>
<ul>
<li><p>0: the <span class="smallcaps">MISR</span> <span class="smallcaps">AGP</span> files,</p></li>
<li><p>1: the <span class="smallcaps">MISR</span> input data files,</p></li>
<li><p>2: the <span class="smallcaps">MISR-HR</span> output products, and</p></li>
<li><p>3: the outcomes of the <span class="smallcaps">MISR-HR</span> post-processing routines.</p></li>
</ul>
<p>These array elements may contain wildcard characters to point to one or more disks or directories.</p></li>
<li><p>the <code>STRING</code> array <code>versions</code> to contain the default version indicators of the various <span class="smallcaps">MISR</span> data and <span class="smallcaps">MISR-HR</span> product files, namely</p>
<ul>
<li><p>0: the version identifier of <span class="smallcaps">MISR</span> <span class="smallcaps">AGP</span> files,</p></li>
<li><p>1: the version identifier of <span class="smallcaps">MISR</span> <span class="smallcaps">Browse</span> files,</p></li>
<li><p>2: the version identifier of <span class="smallcaps">MISR</span> <span class="smallcaps">L1B2 GRP Terrain projected GM</span> files,</p></li>
<li><p>3: the version identifier of <span class="smallcaps">MISR</span> <span class="smallcaps">L1B2 GRP Terrain projected LM</span> files,</p></li>
<li><p>4: the version identifier of <span class="smallcaps">MISR</span> <span class="smallcaps">Geometric Parameters Product</span> files,</p></li>
<li><p>5: the version identifier of <span class="smallcaps">MISR</span> <span class="smallcaps">L1B2 GRP RCCM</span> files,</p></li>
<li><p>6: the version identifier of <span class="smallcaps">MISR</span> <span class="smallcaps">L2 Aerosol</span> files,</p></li>
<li><p>7: the version identifier of <span class="smallcaps">MISR</span> <span class="smallcaps">L2 Land</span> files,</p></li>
<li><p>8: the version identifier of all <span class="smallcaps">MISR-HR</span> product files.</p></li>
</ul></li>
</ul></li>
<li><p><strong>Algorithm:</strong> This function requires no input; it relies on the function <code>get_host_info.pro</code> to identify the underlying operating system and retrieve the computer name, and then sets the default paths to the various <span class="smallcaps">MISR</span> data and <span class="smallcaps">MISR-HR</span> product files. It also sets the default versions of the various <span class="smallcaps">MISR</span> data and <span class="smallcaps">MISR-HR</span> product files.</p></li>
<li><p><strong>Syntax:</strong> <code>rc = set_roots_vers(root_dirs, versions, $</code><br />
<code>DEBUG = debug, EXCPT_COND = excpt_cond)</code></p></li>
<li><p><strong>Positional parameters [Input/Output]:</strong></p>
<ul>
<li><p><code>root_dirs {STRING array} [O]:</code> The array containing the default directory addresses of the folders containing <span class="smallcaps">MISR</span> data and <span class="smallcaps">MISR-HR</span> product files.</p></li>
<li><p><code>versions {STRING array} [O]:</code> The array containing the default version identifiers of the <span class="smallcaps">MISR</span> data and <span class="smallcaps">MISR-HR</span> product files.</p></li>
</ul></li>
<li><p><strong>Keyword parameters [Input/Output]:</strong></p></li>
<li><p><code>DEBUG = debug {INT} [I] (Default value: 0):</code> Flag to activate (<code>1</code>) or skip (<code>0</code>) debugging tests.</p></li>
<li><p><code>EXCPT_COND = excpt_cond {STRING} [O] (Default value: &#8221;):</code> Description of the exception condition if one has been encountered, or a null string otherwise.</p></li>
<li><p><strong>Returned value type:</strong> <code>INT</code>.</p></li>
<li><p><strong>Outcome:</strong></p>
<ul>
<li><p>If no exception condition has been detected, this function returns <code>0</code>, and the output keyword parameter <code>excpt_cond</code> is set to a null string, if the optional input keyword parameter <code>DEBUG</code> is set and if the optional output keyword parameter <code>EXCPT_COND</code> is provided in the call. The output positional parameter(s) <code>root_dirs</code> and <code>versions</code> are defined an initialized.</p></li>
<li><p>If an exception condition has been detected, this function returns a non-zero error code, and the output keyword parameter <code>excpt_cond</code> contains a message about the exception condition encountered, if the optional input keyword parameter <code>DEBUG</code> is set and if the optional output keyword parameter <code>EXCPT_COND</code> is provided. The output positional parameter(s) <code>root_dirs</code> and <code>versions</code> may be inexistent, incomplete or incorrect.</p></li>
</ul></li>
<li><p><strong>Exception conditions:</strong></p>
<ul>
<li><p>Error 99: The operating system or the computer is unrecognized, the default values of directory addresses and version numbers are not set.</p></li>
<li><p>Error 100: One or more positional parameter(s) are missing.</p></li>
</ul></li>
<li><p><strong>Dependencies:</strong></p>
<ul>
<li><p><code>get_host_info.pro</code></p></li>
<li><p><code>strstr.pro</code></p></li>
</ul></li>
<li><p><strong>Remarks:</strong></p>
<ul>
<li><p><strong>Note 1:</strong> If this function does not recognize the operating system or the computer, it returns an error code <code>99</code> and an error message. Processing can proceed, provided the directory addresses of all required input and output folders are explicitly specified through input keyword parameters.</p></li>
<li><p><strong>Note 2:</strong> In other routines of this library, whenever input and output folders are explicitly specified through input keyword parameters, they override the default values set by this function.</p></li>
<li><p><strong>Note 3:</strong> This function currently recognizes the computers named <code>MicMac</code>, <code>MicMac2</code>, <code>pc18</code>, and <code>5CG7213978</code>; other computers can be added by inserting more options in the OS-specific <code>CASE</code> statements.</p></li>
<li><p><strong>Note 4:</strong> This setup assumes that the subdirectory structures below those root directories conform to a preset standard; it allows other programs and functions in this system to read from and write to default folders in those predefined locations, without having to specify their locations explicitly.</p></li>
<li><p><strong>Note 5:</strong> Whenever routines from the <span class="smallcaps">MISR</span> <span class="smallcaps">Toolkit</span> are used, (1) they require directory addresses to be absolute addresses, i.e., from the computer root directory: Do not use the Linux shortcut <span>~</span> to designate the home directory as part of those addresses, and (2) those addresses cannot contain wildcard characters such as <code>?</code> or <code>*</code>.</p></li>
<li><p><strong>Note 6:</strong> It is the user&#8217;s responsibility to correctly set the directory addresses for his or her computer in this function, as the latter does not verify that those folders are readable or writable, since they can be overridden.</p></li>
</ul></li>
<li><p><strong>Examples:</strong></p>
<pre><code>IDL&gt;  = set_roots_dirs(root_dirs, versions, DEBUG = debug, $
   EXCPT_COND = excpt_cond)
IDL&gt; FOR i = 0, 3 DO PRINT, &#39;root_dirs[&#39; + strstr(i) + $
   &#39;] = &#39; + root_dirs[i]
root_dirs[0] = /Users/michel/MISR_HR/Input/AGP/
root_dirs[1] = /Volumes/MISR_Data*/
root_dirs[2] = /Volumes/MISR-HR/
root_dirs[3] = /Users/michel/MISR_HR/Outcomes/</code></pre></li>
<li><p><strong>References:</strong> None.</p></li>
<li><p><strong>Versioning:</strong></p>
<ul>
<li><p>2017&#8211;07&#8211;09: Version 0.9 &#8212; Initial release as <code>set_misr_roots.pro</code>.</p></li>
<li><p>2017&#8211;11&#8211;30: Version 1.0 &#8212; Initial public release.</p></li>
<li><p>2018&#8211;03&#8211;25: Version 1.1 &#8212; Add computer MicMac2.</p></li>
<li><p>2018&#8211;04&#8211;08: Version 1.2 &#8212; Add an array element to point to AGP files, update addresses for pc18 to allow for multiple input and output disks, and rename the function to <code>set_root_dirs.pro</code>.</p></li>
<li><p>2018&#8211;05&#8211;12: Version 1.3 &#8212; Update the documentation to note that the <span class="smallcaps">MISR</span> <span class="smallcaps">Toolkit</span> requires absolute directory adresses.</p></li>
<li><p>2018&#8211;06&#8211;01: Version 1.5 &#8212; Implement new coding standards.</p></li>
<li><p>2018&#8211;07&#8211;02: Version 1.6 &#8212; Revamp the logic to correctly detect and initialize computers running under the Microsoft Windows operating system.</p></li>
<li><p>2018&#8211;07&#8211;05: Version 1.7 &#8212; Update this routine to rely on the function<br />
<code>get_host_info.pro</code>.</p></li>
<li><p>2018&#8211;11&#8211;26: Version 1.8 &#8212; Remove code to stop processing if the computer is unrecognized.</p></li>
<li><p>2019&#8211;01&#8211;07: Version 1.9 &#8212; Upgrade the function to set default version identifiers as well as default paths, now provided as output positional parameters, change the directory address <code>root_dirs[0]</code>, and rename it <code>set_roots_vers.pro</code>.</p></li>
<li><p>2019&#8211;01&#8211;28: Version 2.00 &#8212; Systematic update of all routines to implement stricter coding standards and improve documentation.</p></li>
<li><p>2019&#8211;04&#8211;11: Version 2.01 &#8212; Add pointers to computer <code>rhapsody</code>.</p></li>
<li><p>2019&#8211;05&#8211;08: Version 2.02 &#8212; Update the defaults version number of <span class="smallcaps">MISR-HR</span> products to <code>V2.00-0</code>.</p></li>
<li><p>2019&#8211;08&#8211;20: Version 2.1.0 &#8212; Adopt revised coding and documentation standards (in particular regarding the assignment of numeric return codes), and switch to 3-parts version identifiers.</p></li>
</ul></li>
</ul>
<h2>str2block</h2>
<ul>
<li><p><strong>Purpose:</strong> This function converts a valid <code>STRING</code> representation of a <span class="smallcaps">MISR</span> <span class="smallcaps">Block</span>, with or without the <code>B</code> header, into its <code>INT</code> equivalent; it performs the converse operation of function <code>block2str</code>.</p></li>
<li><p><strong>Algorithm:</strong> This function checks the validity of the input positional parameter<br />
<code>misr_block_str</code>, provided as a <code>STRING</code> value, removes the <code>B</code> header if it is present, and converts the remaining string to an <code>INT</code> integer.</p></li>
<li><p><strong>Syntax:</strong> <code>rc = str2block(misr_block_str, misr_block, $</code><br />
<code>DEBUG = debug, EXCPT_COND = excpt_cond)</code></p></li>
<li><p><strong>Positional parameters [Input/Output]:</strong></p>
<ul>
<li><p><code>misr_block_str {STRING} [I]:</code> The selected <code>STRING</code> representation of the <span class="smallcaps">MISR</span> <span class="smallcaps">Block</span>, with or without the <code>B</code> header.</p></li>
<li><p><code>misr_block {INT} [O]:</code> The required <span class="smallcaps">MISR</span> <span class="smallcaps">Block</span> number.</p></li>
</ul></li>
<li><p><strong>Keyword parameters [Input/Output]:</strong></p>
<ul>
<li><p><code>DEBUG = debug {INT} [I] (Default value: 0):</code> Flag to activate (<code>1</code>) or skip (<code>0</code>) debugging tests.</p></li>
<li><p><code>EXCPT_COND = excpt_cond {STRING} [O] (Default value: &#8221;):</code> Description of the exception condition if one has been encountered, or a null string otherwise.</p></li>
</ul></li>
<li><p><strong>Returned value type:</strong> <code>INT</code>.</p></li>
<li><p><strong>Outcome:</strong></p>
<ul>
<li><p>If no exception condition has been detected, this function returns <code>0</code>, and the output keyword parameter <code>excpt_cond</code> is set to a null string, if the optional input keyword parameter <code>DEBUG</code> was set and if the optional output keyword parameter <code>EXCPT_COND</code> was provided in the call. The output positional parameter <code>misr_block</code> contains the <span class="smallcaps">Block</span> number.</p></li>
<li><p>If an exception condition has been detected, this function returns a non-zero error code, and the output keyword parameter <code>excpt_cond</code> contains a message about the exception condition encountered, if the optional input keyword parameter <code>DEBUG</code> is set and if the optional output keyword parameter <code>EXCPT_COND</code> is provided. The output positional parameter <code>misr_block</code> is set to <code>0</code>.</p></li>
</ul></li>
<li><p><strong>Exception conditions:</strong></p>
<ul>
<li><p>Error 100: One or more positional parameter(s) are missing.</p></li>
<li><p>Error 110: Input positional parameter <code>misr_block_str</code> is not of type <code>STRING</code>.</p></li>
<li><p>Error 200: The numerical value of input positional parameter <code>misr_block_str</code> is invalid.</p></li>
</ul></li>
<li><p><strong>Dependencies:</strong></p>
<ul>
<li><p><code>chk_misr_block.pro</code></p></li>
<li><p><code>first_char.pro</code></p></li>
<li><p><code>is_string.pro</code></p></li>
<li><p><code>strstr.pro</code></p></li>
</ul></li>
<li><p><strong>Remarks:</strong></p>
<ul>
<li><p><strong>Note 1:</strong> The input positional parameter <code>misr_block_str</code> is expected to be a <code>STRING</code> formatted as <code>Bzzz</code> or <code>bzzz</code> or <code>zzz</code>, where <code>zzz</code> is the numeric value of the <span class="smallcaps">MISR</span> <span class="smallcaps">Block</span>.</p></li>
<li><p><strong>Note 2:</strong> The presence of blank spaces before or after the character <code>B</code>, or after the number <code>zzz</code>, is tolerated. See the example below.</p></li>
</ul></li>
<li><p><strong>Examples:</strong></p>
<pre><code>IDL&gt; misr_block_str = &#39; b 111 &#39;
IDL&gt; rc = str2block(misr_block_str, misr_block, $
   /DEBUG, EXCPT_COND = excpt_cond)
IDL&gt; PRINT, &#39;rc = &#39;, rc, &#39; and excpt_cond = &gt;&#39; + excpt_cond + &#39;&lt;&#39;
rc =        0 and excpt_cond = &gt;&lt;
IDL&gt; PRINT, &#39;misr_block = &#39;, misr_block
misr_block =      111</code></pre></li>
<li><p><strong>References:</strong> None.</p></li>
<li><p><strong>Versioning:</strong></p>
<ul>
<li><p>2017&#8211;11&#8211;15: Version 0.9 &#8212; Initial release.</p></li>
<li><p>2017&#8211;11&#8211;30: Version 1.0 &#8212; Initial public release.</p></li>
<li><p>2018&#8211;01&#8211;16: Version 1.1 &#8212; Implement optional debugging.</p></li>
<li><p>2018&#8211;06&#8211;01: Version 1.5 &#8212; Implement new coding standards.</p></li>
<li><p>2019&#8211;01&#8211;28: Version 2.00 &#8212; Systematic update of all routines to implement stricter coding standards and improve documentation.</p></li>
<li><p>2019&#8211;02&#8211;25: Version 2.01 &#8212; Bug fix: Preserve input argument.</p></li>
<li><p>2019&#8211;08&#8211;20: Version 2.1.0 &#8212; Adopt revised coding and documentation standards (in particular regarding the assignment of numeric return codes), and switch to 3-parts version identifiers.</p></li>
</ul></li>
</ul>
<h2>str2orbit</h2>
<ul>
<li><p><strong>Purpose:</strong> This function converts a valid <code>STRING</code> representation of a <span class="smallcaps">MISR</span> <span class="smallcaps">Orbit</span>, with or without the <code>O</code> header, into its <code>LONG</code> equivalent; it performs the converse operation of function <code>orbit2str</code>.</p></li>
<li><p><strong>Algorithm:</strong> This function checks the validity of the input positional parameter<br />
<code>misr_orbit_str</code>, provided as an <code>STRING</code> value, removes the <code>B</code> header if it is present, and converts remaining string to a <code>LONG</code> integer.</p></li>
<li><p><strong>Syntax:</strong> <code>rc = str2orbit(misr_orbit_str, misr_orbit, $</code><br />
<code>DEBUG = debug, EXCPT_COND = excpt_cond)</code></p></li>
<li><p><strong>Positional parameters [Input/Output]:</strong></p>
<ul>
<li><p><code>misr_orbit_str {STRING} [I]:</code> The selected <code>STRING</code> representation of the <span class="smallcaps">MISR</span> <span class="smallcaps">Orbit</span>, with or without the <code>O</code> header.</p></li>
<li><p><code>misr_orbit {LONG} [O]:</code> The required <span class="smallcaps">MISR</span> <span class="smallcaps">Orbit</span> number.</p></li>
</ul></li>
<li><p><strong>Keyword parameters [Input/Output]:</strong></p>
<ul>
<li><p><code>DEBUG = debug {INT} [I] (Default value: 0):</code> Flag to activate (<code>1</code>) or skip (<code>0</code>) debugging tests.</p></li>
<li><p><code>EXCPT_COND = excpt_cond {STRING} [O] (Default value: &#8221;):</code> Description of the exception condition if one has been encountered, or a null string otherwise.</p></li>
</ul></li>
<li><p><strong>Returned value type:</strong> <code>INT</code>.</p></li>
<li><p><strong>Outcome:</strong></p>
<ul>
<li><p>If no exception condition has been detected, this function returns <code>0</code>, and the output keyword parameter <code>excpt_cond</code> is set to a null string, if the optional input keyword parameter <code>DEBUG</code> was set and if the optional output keyword parameter <code>EXCPT_COND</code> was provided in the call. The output positional parameter <code>misr_orbit</code> contains the <span class="smallcaps">Orbit</span> number.</p></li>
<li><p>If an exception condition has been detected, this function returns a non-zero error code, and the output keyword parameter <code>excpt_cond</code> contains a message about the exception condition encountered, if the optional input keyword parameter <code>DEBUG</code> is set and if the optional output keyword parameter <code>EXCPT_COND</code> is provided. The output positional parameter <code>misr_orbit</code> is set to <code>0</code>.</p></li>
</ul></li>
<li><p><strong>Exception conditions:</strong></p>
<ul>
<li><p>Error 100: One or more positional parameter(s) are missing.</p></li>
<li><p>Error 110: Input positional parameter <code>misr_orbit_str</code> is not of type <code>STRING</code>.</p></li>
<li><p>Error 200: The numerical value of input positional parameter <code>misr_orbit_str</code> is invalid.</p></li>
</ul></li>
<li><p><strong>Dependencies:</strong></p>
<ul>
<li><p><code>chk_misr_orbit.pro</code></p></li>
<li><p><code>first_char.pro</code></p></li>
<li><p><code>is_string.pro</code></p></li>
<li><p><code>strstr.pro</code></p></li>
</ul></li>
<li><p><strong>Remarks:</strong></p>
<ul>
<li><p><strong>Note 1:</strong> The input positional parameter <code>misr_orbit_str</code> is expected to be a <code>STRING</code> formatted as <code>Oyyyyyy</code> or <code>oyyyyyy</code> or <code>yyyyyy</code>, where <code>yyyyyy</code> is the numeric value of the <span class="smallcaps">MISR</span> <span class="smallcaps">Orbit</span>.</p></li>
<li><p><strong>Note 2:</strong> The presence of blank spaces before or after the character <code>O</code>, or after the number <code>yyyyyy</code>, is tolerated. See the example below.</p></li>
</ul></li>
<li><p><strong>Examples:</strong></p>
<pre><code>IDL&gt; misr_orbit_str = &#39; o 68050 &#39;
IDL&gt; rc = str2orbit(misr_orbit_str, misr_orbit, $
   /DEBUG, EXCPT_COND = excpt_cond)
IDL&gt; PRINT, &#39;rc = &#39;, rc, &#39; and excpt_cond = &gt;&#39; + excpt_cond + &#39;&lt;&#39;
rc =        0 and excpt_cond = &gt;&lt;
IDL&gt; PRINT, &#39;misr_orbit = &#39;, misr_orbit
misr_orbit =        68050</code></pre></li>
<li><p><strong>References:</strong> None.</p></li>
<li><p><strong>Versioning:</strong></p>
<ul>
<li><p>2017&#8211;11&#8211;15: Version 0.9 &#8212; Initial release.</p></li>
<li><p>2017&#8211;11&#8211;30: Version 1.0 &#8212; Initial public release.</p></li>
<li><p>2018&#8211;01&#8211;16: Version 1.1 &#8212; Implement optional debugging.</p></li>
<li><p>2018&#8211;04&#8211;24: Version 1.2 &#8212; Improve debugging diagnostic.</p></li>
<li><p>2018&#8211;06&#8211;01: Version 1.5 &#8212; Implement new coding standards.</p></li>
<li><p>2019&#8211;01&#8211;28: Version 2.00 &#8212; Systematic update of all routines to implement stricter coding standards and improve documentation.</p></li>
<li><p>2019&#8211;02&#8211;25: Version 2.01 &#8212; Bug fix: Preserve input argument.</p></li>
<li><p>2019&#8211;08&#8211;20: Version 2.1.0 &#8212; Adopt revised coding and documentation standards (in particular regarding the assignment of numeric return codes), and switch to 3-parts version identifiers.</p></li>
</ul></li>
</ul>
<h2>str2path</h2>
<ul>
<li><p><strong>Purpose:</strong> This function converts a valid <code>STRING</code> representation of a <span class="smallcaps">MISR</span> <span class="smallcaps">Path</span>, with or without the <code>P</code> header, into its <code>INT</code> equivalent; it performs the converse operation of function <code>path2str</code>.</p></li>
<li><p><strong>Algorithm:</strong> This function checks the validity of the input positional parameter<br />
<code>misr_path_str</code>, provided as an <code>STRING</code> value, removes the <code>P</code> header if it is present, and converts remaining string to an <code>INT</code> integer.</p></li>
<li><p><strong>Syntax:</strong> <code>rc = str2path(misr_path_str, misr_path, $</code><br />
<code>DEBUG = debug, EXCPT_COND = excpt_cond)</code></p></li>
<li><p><strong>Positional parameters [Input/Output]:</strong></p>
<ul>
<li><p><code>misr_path_str {STRING} [I]:</code> The selected <code>STRING</code> representation of the <span class="smallcaps">MISR</span> <span class="smallcaps">Path</span>, with or without the <code>P</code> header.</p></li>
<li><p><code>misr_path {INT} [O]:</code> The required <span class="smallcaps">MISR</span> <span class="smallcaps">Path</span> number.</p></li>
</ul></li>
<li><p><strong>Keyword parameters [Input/Output]:</strong></p>
<ul>
<li><p><code>DEBUG = debug {INT} [I] (Default value: 0):</code> Flag to activate (<code>1</code>) or skip (<code>0</code>) debugging tests.</p></li>
<li><p><code>EXCPT_COND = excpt_cond {STRING} [O] (Default value: &#8221;):</code> Description of the exception condition if one has been encountered, or a null string otherwise.</p></li>
</ul></li>
<li><p><strong>Returned value type:</strong> <code>INT</code>.</p></li>
<li><p><strong>Outcome:</strong></p>
<ul>
<li><p>If no exception condition has been detected, this function returns <code>0</code>, and the output keyword parameter <code>excpt_cond</code> is set to a null string, if the optional input keyword parameter <code>DEBUG</code> was set and if the optional output keyword parameter <code>EXCPT_COND</code> was provided in the call. The output positional parameter <code>misr_path</code> contains the <span class="smallcaps">Path</span> number.</p></li>
<li><p>If an exception condition has been detected, this function returns a non-zero error code, and the output keyword parameter <code>excpt_cond</code> contains a message about the exception condition encountered, if the optional input keyword parameter <code>DEBUG</code> is set and if the optional output keyword parameter <code>EXCPT_COND</code> is provided. The output positional parameter <code>misr_path</code> is set to <code>0</code>.</p></li>
</ul></li>
<li><p><strong>Exception conditions:</strong></p>
<ul>
<li><p>Error 100: One or more positional parameter(s) are missing.</p></li>
<li><p>Error 110: Input positional parameter <code>misr_path_str</code> is not of type <code>STRING</code>.</p></li>
<li><p>Error 200: The numerical value of input positional parameter <code>misr_path_str</code> is invalid.</p></li>
</ul></li>
<li><p><strong>Dependencies:</strong></p>
<ul>
<li><p><code>chk_misr_path.pro</code></p></li>
<li><p><code>first_char.pro</code></p></li>
<li><p><code>is_string.pro</code></p></li>
<li><p><code>strstr.pro</code></p></li>
</ul></li>
<li><p><strong>Remarks:</strong></p>
<ul>
<li><p><strong>Note 1:</strong> The input positional parameter <code>misr_path_str</code> is expected to be a <code>STRING</code> formatted as <code>Pxxx</code> or <code>pxxx</code> or <code>xxx</code>, where <code>xxx</code> is the numeric value of the <span class="smallcaps">MISR</span> <span class="smallcaps">Path</span>.</p></li>
<li><p><strong>Note 2:</strong> The presence of blank spaces before or after the character <code>P</code>, or after the number <code>xxx</code>, is tolerated. See the example below.</p></li>
</ul></li>
<li><p><strong>Examples:</strong></p>
<pre><code>IDL&gt; misr_path_str = &#39;p 170 &#39;
IDL&gt; rc = str2path(misr_path_str, misr_path, $
   /DEBUG, EXCPT_COND = excpt_cond)
IDL&gt; PRINT, &#39;rc = &#39;, rc, &#39; and excpt_cond = &gt;&#39; + excpt_cond + &#39;&lt;&#39;
rc =        0 and excpt_cond = &gt;&lt;
IDL&gt; PRINT, &#39;misr_path = &#39;, misr_path
misr_path =      170</code></pre></li>
<li><p><strong>References:</strong> None.</p></li>
<li><p><strong>Versioning:</strong></p>
<ul>
<li><p>2017&#8211;11&#8211;15: Version 0.9 &#8212; Initial release.</p></li>
<li><p>2017&#8211;11&#8211;30: Version 1.0 &#8212; Initial public release.</p></li>
<li><p>2018&#8211;01&#8211;16: Version 1.1 &#8212; Implement optional debugging.</p></li>
<li><p>2018&#8211;06&#8211;01: Version 1.5 &#8212; Implement new coding standards.</p></li>
<li><p>2019&#8211;01&#8211;28: Version 2.00 &#8212; Systematic update of all routines to implement stricter coding standards and improve documentation.</p></li>
<li><p>2019&#8211;02&#8211;25: Version 2.01 &#8212; Bug fix: Preserve input argument.</p></li>
<li><p>2019&#8211;08&#8211;20: Version 2.1.0 &#8212; Adopt revised coding and documentation standards (in particular regarding the assignment of numeric return codes), and switch to 3-parts version identifiers.</p></li>
</ul></li>
</ul>
</body>
</html>
